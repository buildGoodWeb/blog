<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/blog/commons.f933939570d27fef2133.css">.theme-light{background-color:#f4f5f5}.theme-dark,.theme-light{-webkit-transition:.5s;transition:.5s;min-height:100vh}.theme-dark{background-color:#181818}svg{display:inline-block;stroke-width:0;stroke:currentColor;fill:currentColor;pointer-events:none}.layout{margin:0 auto;max-width:56rem;padding:3rem 1.5rem}.theme-light .layout{color:#555}.theme-dark .layout{color:#fff}.layout header{display:flex;align-items:baseline;justify-content:space-between}.layout .toggle{line-height:1;display:inline-block;cursor:pointer}.layout .toggle:hover{color:#0078e7}.layout.post ul li{line-height:1.75}.layout.post img{border-radius:5px;position:absolute;top:0}@media (min-width:768px){.layout table td,.layout table th{padding:12px 24px}}@media (max-width:768px){.layout body{font-size:12px}.layout table td,.layout table th{padding:8px 4px;word-break:break-all}}.layout table{width:100%;margin:8px 0 16px}.layout table th{color:#5c6b77;font-weight:500;white-space:nowrap;background:rgba(0,0,0,.02);border:1px solid #ebedf0}.layout table td{text-align:left;border:1px solid #ebedf0}</style><style data-href="/blog/styles.2d5671466d9414184026.css">.node{cursor:pointer}.node circle{fill:#4682b4;stroke:#000}.link{fill:none;stroke:#ccc;stroke-width:1px}.playground{font-size:13px;border-radius:4px;padding:5px;color:#fff}.playground .container{width:100%;border:1px solid #ccc;margin-bottom:8px}.playground .item{border:1px dotted #ccc;margin:8px}.playground .margin4{margin-right:4px}.playground.show{background-color:#234361}.playground-error{background-color:#f24542;border-radius:4px}.playground-error pre{padding:15px;background-color:transparent;border:0;color:inherit}.playground-view{background-color:#fff;border-radius:3px;color:#66788a;margin:4px;padding:16px;border:1px solid #ccc;display:flex;justify-content:space-between}.playground-view>div{width:90%}.playground-view>button{opacity:0;align-self:flex-end;-webkit-transition:opacity .3s ease;transition:opacity .3s ease}.heading:hover .anchor,.playground-view:hover button{opacity:1}.heading .anchor{margin-left:8px;opacity:0;-webkit-transition:opacity .3s ease;transition:opacity .3s ease;text-decoration:none}.main-toc{position:fixed;right:.5rem;top:4rem;margin-top:25px;padding-left:15px}.main-toc>div{line-height:2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.main-toc--li2{font-size:14px}.main-toc--li3{font-size:12px;padding-left:10px}.main-toc--li4{font-size:12px;padding-left:20px}.main-toc a{text-decoration:none}.theme-light .main-toc a{color:#555}.theme-dark .main-toc a{color:#fff}.main-toc a.current,.main-toc a:hover{color:#337ab7}@media (min-width:900px){.main-toc{width:12rem}}@media (max-width:900px){.main-toc{position:static}}.bio{display:flex;margin-bottom:2rem}.bio img{margin-bottom:0;margin-right:2rem;min-width:50px;border-radius:50%}

/*!
Pure v1.0.1
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/pure-css/pure/blob/master/LICENSE.md
*/
/*!
normalize.css v^3.0 | MIT License | git.io/normalize
Copyright (c) Nicolas Gallagher and Jonathan Neal
*/
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}.hidden,[hidden]{display:none!important}.pure-img{max-width:100%;height:auto;display:block}.pure-g{letter-spacing:-.31em;text-rendering:optimizespeed;font-family:FreeSans,Arimo,Droid Sans,Helvetica,Arial,sans-serif;display:flex;flex-flow:row wrap;align-content:flex-start}@media (-ms-high-contrast:active),(-ms-high-contrast:none){table .pure-g{display:block}}.opera-only :-o-prefocus,.pure-g{word-spacing:-.43em}.pure-u{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-g [class*=pure-u]{font-family:sans-serif}.pure-u-1,.pure-u-1-1,.pure-u-1-2,.pure-u-1-3,.pure-u-1-4,.pure-u-1-5,.pure-u-1-6,.pure-u-1-8,.pure-u-1-12,.pure-u-1-24,.pure-u-2-3,.pure-u-2-5,.pure-u-2-24,.pure-u-3-4,.pure-u-3-5,.pure-u-3-8,.pure-u-3-24,.pure-u-4-5,.pure-u-4-24,.pure-u-5-5,.pure-u-5-6,.pure-u-5-8,.pure-u-5-12,.pure-u-5-24,.pure-u-6-24,.pure-u-7-8,.pure-u-7-12,.pure-u-7-24,.pure-u-8-24,.pure-u-9-24,.pure-u-10-24,.pure-u-11-12,.pure-u-11-24,.pure-u-12-24,.pure-u-13-24,.pure-u-14-24,.pure-u-15-24,.pure-u-16-24,.pure-u-17-24,.pure-u-18-24,.pure-u-19-24,.pure-u-20-24,.pure-u-21-24,.pure-u-22-24,.pure-u-23-24,.pure-u-24-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-1-24{width:4.1667%}.pure-u-1-12,.pure-u-2-24{width:8.3333%}.pure-u-1-8,.pure-u-3-24{width:12.5%}.pure-u-1-6,.pure-u-4-24{width:16.6667%}.pure-u-1-5{width:20%}.pure-u-5-24{width:20.8333%}.pure-u-1-4,.pure-u-6-24{width:25%}.pure-u-7-24{width:29.1667%}.pure-u-1-3,.pure-u-8-24{width:33.3333%}.pure-u-3-8,.pure-u-9-24{width:37.5%}.pure-u-2-5{width:40%}.pure-u-5-12,.pure-u-10-24{width:41.6667%}.pure-u-11-24{width:45.8333%}.pure-u-1-2,.pure-u-12-24{width:50%}.pure-u-13-24{width:54.1667%}.pure-u-7-12,.pure-u-14-24{width:58.3333%}.pure-u-3-5{width:60%}.pure-u-5-8,.pure-u-15-24{width:62.5%}.pure-u-2-3,.pure-u-16-24{width:66.6667%}.pure-u-17-24{width:70.8333%}.pure-u-3-4,.pure-u-18-24{width:75%}.pure-u-19-24{width:79.1667%}.pure-u-4-5{width:80%}.pure-u-5-6,.pure-u-20-24{width:83.3333%}.pure-u-7-8,.pure-u-21-24{width:87.5%}.pure-u-11-12,.pure-u-22-24{width:91.6667%}.pure-u-23-24{width:95.8333%}.pure-u-1,.pure-u-1-1,.pure-u-5-5,.pure-u-24-24{width:100%}.pure-button{display:inline-block;zoom:1;line-height:normal;white-space:nowrap;vertical-align:middle;text-align:center;cursor:pointer;-webkit-user-drag:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;box-sizing:border-box}.pure-button::-moz-focus-inner{padding:0;border:0}.pure-button-group{letter-spacing:-.31em;text-rendering:optimizespeed}.opera-only :-o-prefocus,.pure-button-group{word-spacing:-.43em}.pure-button-group .pure-button{letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-button{font-family:inherit;font-size:100%;padding:.5em 1em;color:#444;color:rgba(0,0,0,.8);border:transparent;background-color:#e6e6e6;text-decoration:none;border-radius:2px}.pure-button-hover,.pure-button:focus,.pure-button:hover{background-image:-webkit-gradient(linear,left top,left bottom,from(transparent),color-stop(40%,rgba(0,0,0,.05)),to(rgba(0,0,0,.1)));background-image:linear-gradient(transparent,rgba(0,0,0,.05) 40%,rgba(0,0,0,.1))}.pure-button:focus{outline:0}.pure-button-active,.pure-button:active{box-shadow:inset 0 0 0 1px rgba(0,0,0,.15),inset 0 0 6px rgba(0,0,0,.2);border-color:#000}.pure-button-disabled,.pure-button-disabled:active,.pure-button-disabled:focus,.pure-button-disabled:hover,.pure-button[disabled]{border:none;background-image:none;opacity:.4;cursor:not-allowed;box-shadow:none;pointer-events:none}.pure-button-hidden{display:none}.pure-button-primary,.pure-button-selected,a.pure-button-primary,a.pure-button-selected{background-color:#0078e7;color:#fff}.pure-button-group .pure-button{margin:0;border-radius:0;border-right:1px solid #111;border-right:1px solid rgba(0,0,0,.2)}.pure-button-group .pure-button:first-child{border-top-left-radius:2px;border-bottom-left-radius:2px}.pure-button-group .pure-button:last-child{border-top-right-radius:2px;border-bottom-right-radius:2px;border-right:none}.pure-form input[type=color],.pure-form input[type=date],.pure-form input[type=datetime-local],.pure-form input[type=datetime],.pure-form input[type=email],.pure-form input[type=month],.pure-form input[type=number],.pure-form input[type=password],.pure-form input[type=search],.pure-form input[type=tel],.pure-form input[type=text],.pure-form input[type=time],.pure-form input[type=url],.pure-form input[type=week],.pure-form select,.pure-form textarea{padding:.5em .6em;display:inline-block;border:1px solid #ccc;box-shadow:inset 0 1px 3px #ddd;border-radius:4px;vertical-align:middle;box-sizing:border-box}.pure-form input:not([type]){padding:.5em .6em;display:inline-block;border:1px solid #ccc;box-shadow:inset 0 1px 3px #ddd;border-radius:4px;box-sizing:border-box}.pure-form input[type=color]{padding:.2em .5em}.pure-form input:not([type]):focus,.pure-form input[type=color]:focus,.pure-form input[type=date]:focus,.pure-form input[type=datetime-local]:focus,.pure-form input[type=datetime]:focus,.pure-form input[type=email]:focus,.pure-form input[type=month]:focus,.pure-form input[type=number]:focus,.pure-form input[type=password]:focus,.pure-form input[type=search]:focus,.pure-form input[type=tel]:focus,.pure-form input[type=text]:focus,.pure-form input[type=time]:focus,.pure-form input[type=url]:focus,.pure-form input[type=week]:focus,.pure-form select:focus,.pure-form textarea:focus{outline:0;border-color:#129fea}.pure-form input[type=checkbox]:focus,.pure-form input[type=file]:focus,.pure-form input[type=radio]:focus{outline:thin solid #129fea;outline:1px auto #129fea}.pure-form .pure-checkbox,.pure-form .pure-radio{margin:.5em 0;display:block}.pure-form input:not([type])[disabled],.pure-form input[type=color][disabled],.pure-form input[type=date][disabled],.pure-form input[type=datetime-local][disabled],.pure-form input[type=datetime][disabled],.pure-form input[type=email][disabled],.pure-form input[type=month][disabled],.pure-form input[type=number][disabled],.pure-form input[type=password][disabled],.pure-form input[type=search][disabled],.pure-form input[type=tel][disabled],.pure-form input[type=text][disabled],.pure-form input[type=time][disabled],.pure-form input[type=url][disabled],.pure-form input[type=week][disabled],.pure-form select[disabled],.pure-form textarea[disabled]{cursor:not-allowed;background-color:#eaeded;color:#cad2d3}.pure-form input[readonly],.pure-form select[readonly],.pure-form textarea[readonly]{background-color:#eee;color:#777;border-color:#ccc}.pure-form input:focus:invalid,.pure-form select:focus:invalid,.pure-form textarea:focus:invalid{color:#b94a48;border-color:#e9322d}.pure-form input[type=checkbox]:focus:invalid:focus,.pure-form input[type=file]:focus:invalid:focus,.pure-form input[type=radio]:focus:invalid:focus{outline-color:#e9322d}.pure-form select{height:2.25em;border:1px solid #ccc;background-color:#fff}.pure-form select[multiple]{height:auto}.pure-form label{margin:.5em 0 .2em}.pure-form fieldset{margin:0;padding:.35em 0 .75em;border:0}.pure-form legend{display:block;width:100%;padding:.3em 0;margin-bottom:.3em;color:#333;border-bottom:1px solid #e5e5e5}.pure-form-stacked input:not([type]),.pure-form-stacked input[type=color],.pure-form-stacked input[type=date],.pure-form-stacked input[type=datetime-local],.pure-form-stacked input[type=datetime],.pure-form-stacked input[type=email],.pure-form-stacked input[type=file],.pure-form-stacked input[type=month],.pure-form-stacked input[type=number],.pure-form-stacked input[type=password],.pure-form-stacked input[type=search],.pure-form-stacked input[type=tel],.pure-form-stacked input[type=text],.pure-form-stacked input[type=time],.pure-form-stacked input[type=url],.pure-form-stacked input[type=week],.pure-form-stacked label,.pure-form-stacked select,.pure-form-stacked textarea{display:block;margin:.25em 0}.pure-form-aligned .pure-help-inline,.pure-form-aligned input,.pure-form-aligned select,.pure-form-aligned textarea,.pure-form-message-inline{display:inline-block;vertical-align:middle}.pure-form-aligned textarea{vertical-align:top}.pure-form-aligned .pure-control-group{margin-bottom:.5em}.pure-form-aligned .pure-control-group label{text-align:right;display:inline-block;vertical-align:middle;width:10em;margin:0 1em 0 0}.pure-form-aligned .pure-controls{margin:1.5em 0 0 11em}.pure-form .pure-input-rounded,.pure-form input.pure-input-rounded{border-radius:2em;padding:.5em 1em}.pure-form .pure-group fieldset{margin-bottom:10px}.pure-form .pure-group input,.pure-form .pure-group textarea{display:block;padding:10px;margin:0 0 -1px;border-radius:0;position:relative;top:-1px}.pure-form .pure-group input:focus,.pure-form .pure-group textarea:focus{z-index:3}.pure-form .pure-group input:first-child,.pure-form .pure-group textarea:first-child{top:1px;border-radius:4px 4px 0 0;margin:0}.pure-form .pure-group input:first-child:last-child,.pure-form .pure-group textarea:first-child:last-child{top:1px;border-radius:4px;margin:0}.pure-form .pure-group input:last-child,.pure-form .pure-group textarea:last-child{top:-2px;border-radius:0 0 4px 4px;margin:0}.pure-form .pure-group button{margin:.35em 0}.pure-form .pure-input-1{width:100%}.pure-form .pure-input-3-4{width:75%}.pure-form .pure-input-2-3{width:66%}.pure-form .pure-input-1-2{width:50%}.pure-form .pure-input-1-3{width:33%}.pure-form .pure-input-1-4{width:25%}.pure-form-message-inline,.pure-form .pure-help-inline{display:inline-block;padding-left:.3em;color:#666;vertical-align:middle;font-size:.875em}.pure-form-message{display:block;color:#666;font-size:.875em}@media only screen and (max-width:480px){.pure-form button[type=submit]{margin:.7em 0 0}.pure-form input:not([type]),.pure-form input[type=color],.pure-form input[type=date],.pure-form input[type=datetime-local],.pure-form input[type=datetime],.pure-form input[type=email],.pure-form input[type=month],.pure-form input[type=number],.pure-form input[type=password],.pure-form input[type=search],.pure-form input[type=tel],.pure-form input[type=text],.pure-form input[type=time],.pure-form input[type=url],.pure-form input[type=week],.pure-form label{margin-bottom:.3em;display:block}.pure-group input:not([type]),.pure-group input[type=color],.pure-group input[type=date],.pure-group input[type=datetime-local],.pure-group input[type=datetime],.pure-group input[type=email],.pure-group input[type=month],.pure-group input[type=number],.pure-group input[type=password],.pure-group input[type=search],.pure-group input[type=tel],.pure-group input[type=text],.pure-group input[type=time],.pure-group input[type=url],.pure-group input[type=week]{margin-bottom:0}.pure-form-aligned .pure-control-group label{margin-bottom:.3em;text-align:left;display:block;width:100%}.pure-form-aligned .pure-controls{margin:1.5em 0 0}.pure-form-message,.pure-form-message-inline,.pure-form .pure-help-inline{display:block;font-size:.75em;padding:.2em 0 .8em}}.pure-menu{box-sizing:border-box}.pure-menu-fixed{position:fixed;left:0;top:0;z-index:3}.pure-menu-item,.pure-menu-list{position:relative}.pure-menu-list{list-style:none;margin:0;padding:0}.pure-menu-item{padding:0;margin:0;height:100%}.pure-menu-heading,.pure-menu-link{display:block;text-decoration:none;white-space:nowrap}.pure-menu-horizontal{width:100%;white-space:nowrap}.pure-menu-horizontal .pure-menu-list{display:inline-block}.pure-menu-horizontal .pure-menu-heading,.pure-menu-horizontal .pure-menu-item,.pure-menu-horizontal .pure-menu-separator{display:inline-block;zoom:1;vertical-align:middle}.pure-menu-item .pure-menu-item{display:block}.pure-menu-children{display:none;position:absolute;left:100%;top:0;margin:0;padding:0;z-index:3}.pure-menu-horizontal .pure-menu-children{left:0;top:auto;width:inherit}.pure-menu-active>.pure-menu-children,.pure-menu-allow-hover:hover>.pure-menu-children{display:block;position:absolute}.pure-menu-has-children>.pure-menu-link:after{padding-left:.5em;content:"\25B8";font-size:small}.pure-menu-horizontal .pure-menu-has-children>.pure-menu-link:after{content:"\25BE"}.pure-menu-scrollable{overflow-y:scroll;overflow-x:hidden}.pure-menu-scrollable .pure-menu-list{display:block}.pure-menu-horizontal.pure-menu-scrollable .pure-menu-list{display:inline-block}.pure-menu-horizontal.pure-menu-scrollable{white-space:nowrap;overflow-y:hidden;overflow-x:auto;-webkit-overflow-scrolling:touch;padding:.5em 0}.pure-menu-horizontal .pure-menu-children .pure-menu-separator,.pure-menu-separator{background-color:#ccc;height:1px;margin:.3em 0}.pure-menu-horizontal .pure-menu-separator{width:1px;height:1.3em;margin:0 .3em}.pure-menu-horizontal .pure-menu-children .pure-menu-separator{display:block;width:auto}.pure-menu-heading{text-transform:uppercase;color:#565d64}.pure-menu-link{color:#777}.pure-menu-children{background-color:#fff}.pure-menu-disabled,.pure-menu-heading,.pure-menu-link{padding:.5em 1em}.pure-menu-disabled{opacity:.5}.pure-menu-disabled .pure-menu-link:hover{background-color:transparent}.pure-menu-active>.pure-menu-link,.pure-menu-link:focus,.pure-menu-link:hover{background-color:#eee}.pure-menu-selected>.pure-menu-link,.pure-menu-selected>.pure-menu-link:visited{color:#000}.pure-table{border-collapse:collapse;border-spacing:0;empty-cells:show;border:1px solid #cbcbcb}.pure-table caption{color:#000;font:italic 85%/1 arial,sans-serif;padding:1em 0;text-align:center}.pure-table td,.pure-table th{border-left:1px solid #cbcbcb;border-bottom-width:0;border-right-width:0;border-top-width:0;font-size:inherit;margin:0;overflow:visible;padding:.5em 1em}.pure-table thead{background-color:#e0e0e0;color:#000;text-align:left;vertical-align:bottom}.pure-table td{background-color:transparent}.pure-table-odd td,.pure-table-striped tr:nth-child(2n-1) td{background-color:#f2f2f2}.pure-table-bordered td{border-bottom:1px solid #cbcbcb}.pure-table-bordered tbody>tr:last-child>td{border-bottom-width:0}.pure-table-horizontal td,.pure-table-horizontal th{border-width:0 0 1px;border-bottom:1px solid #cbcbcb}.pure-table-horizontal tbody>tr:last-child>td{border-bottom-width:0}body,html{font-size:15px;font-family:Helvetica Neue,Helvetica,PingFang SC,Arial,Microsoft YaHei,"\5FAE\8F6F\96C5\9ED1"}.pre{border-radius:4px;margin-bottom:10px}a{color:#0078e7;text-decoration:none}a:hover{opacity:.9}code{font-size:87.5%;color:#e83e8c;word-break:break-word}details{margin:15px 0;cursor:pointer}details summary:focus,details summary:hover{color:#337ab7;outline:none}.post h2:before,.post h3:before{display:block;height:1rem;margin-top:-1rem;visibility:hidden;content:""}.post h1 span{font-size:14px;padding-left:10px;color:#bbb}.post h1 a{font-size:16px;padding-left:12px}h1{margin-top:8px;margin-bottom:20px;font-weight:500;font-size:30px}h2{font-size:24px;line-height:32px}h3{font-size:20px;line-height:28px}.prev-next-nav{overflow:hidden;font-size:14px;border-top:1px solid #ebedf0}.prev-next-nav .next-page,.prev-next-nav .prev-page{display:block;width:50%;height:72px;line-height:72px}.prev-next-nav .prev-page{float:left}.prev-next-nav .next-page{float:right;text-align:right}.all-header{margin-bottom:30px}.all-header h3 span{font-size:13px;padding-left:10px;color:#bbb}.theme-light .all-header p{color:#555}.theme-dark .all-header p{color:#fff}.pagination{display:flex;justify-content:space-between;border-top:1px solid #ebedf0;padding:20px 0}.pagination .pages a{border:1px solid #ebedf0;border-radius:3px;padding:5px 12px;margin:0 5px}.pagination .pages a[aria-current=page]{color:#fff;background:#007acc}blockquote{background-color:#ddd;margin-left:0;margin-right:0;padding:1px 16px;border-left:2px solid #568bec}</style><meta name="generator" content="Gatsby 2.16.3"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="shortcut icon" href="/blog/icons/icon-48x48.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="manifest" href="/blog/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><title data-react-helmet="true">Node Stream 下载 | Kailang Blog</title><meta data-react-helmet="true" name="description" content="通过 Node Stream 处理多种文件下载需求。"/><meta data-react-helmet="true" property="og:title" content="Node Stream 下载"/><meta data-react-helmet="true" property="og:description" content="通过 Node Stream 处理多种文件下载需求。"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="kailang"/><meta data-react-helmet="true" name="twitter:title" content="Node Stream 下载"/><meta data-react-helmet="true" name="twitter:description" content="通过 Node Stream 处理多种文件下载需求。"/><link as="script" rel="preload" href="/blog/component---src-templates-blog-post-js-ad0d66018576bc9befc8.js"/><link as="script" rel="preload" href="/blog/styles-50947f8f1e6f46efd725.js"/><link as="script" rel="preload" href="/blog/commons-f3268c9d7cfa9cf83b38.js"/><link as="script" rel="preload" href="/blog/app-aede868c16b590a60b51.js"/><link as="script" rel="preload" href="/blog/webpack-runtime-e7215cf539a6f354666c.js"/><link as="fetch" rel="preload" href="/blog/page-data/node-stream-download/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="theme-light"><div class="layout post"><header><h3><a href="/blog/">Kailang Blog</a></h3><div class="toggle"><svg viewBox="0 0 1024 1024" width="32" height="14"><path d="M556.8 979.2c-262.4 0-473.6-211.2-473.6-467.2s211.2-467.2 467.2-467.2c12.8 0 19.2 6.4 25.6 12.8 6.4 12.8 6.4 19.2 0 32-57.6 70.4-83.2 160-83.2 249.6 0 230.4 185.6 416 416 416h6.4c12.8 0 19.2 6.4 25.6 12.8 6.4 12.8 6.4 19.2 0 32a498.56 498.56 0 0 1-384 179.2z m-64-876.8c-198.4 32-352 204.8-352 409.6 0 230.4 185.6 416 416 416 108.8 0 211.2-44.8 288-121.6-236.8-25.6-416-230.4-416-467.2 0-89.6 25.6-166.4 64-236.8z" fill="" p-id="4160"></path><path d="M582.4 883.2c-192 0-352-134.4-384-320 0-6.4 6.4-12.8 12.8-19.2 6.4 0 12.8 6.4 19.2 12.8 32 172.8 179.2 294.4 352 294.4 6.4 0 12.8 6.4 12.8 12.8 0 12.8-6.4 19.2-12.8 19.2zM204.8 531.2c-6.4 0-12.8-6.4-12.8-12.8v-19.2c0-6.4 6.4-12.8 12.8-12.8s12.8 6.4 12.8 12.8v19.2c6.4 6.4 0 12.8-12.8 12.8z" fill="" p-id="4161"></path><path d="M620.8 307.2m-25.6 0a25.6 25.6 0 1 0 51.2 0 25.6 25.6 0 1 0-51.2 0Z" fill="" p-id="4162"></path><path d="M793.6 185.6m-25.6 0a25.6 25.6 0 1 0 51.2 0 25.6 25.6 0 1 0-51.2 0Z" fill="" p-id="4163"></path><path d="M736 416m-25.6 0a25.6 25.6 0 1 0 51.2 0 25.6 25.6 0 1 0-51.2 0Z" fill="" p-id="4164"></path></svg></div></header><main><h1>Node Stream 下载<span>2020-11-12</span><a target="_blank" rel="noopener noreferrer" href="/blog/static/node-stream-download-173031f296265ed3d696cb667378f528.pdf" title="打开 node-stream-download.pdf 文件">Θ</a></h1><div class="main-toc row"><div>目录</div><div class="main-toc--li2"><a href="#Stream%20%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD" class="">Stream 大文件下载</a></div><div class="main-toc--li2"><a href="#%E5%A4%A7%E6%96%87%E4%BB%B6%E5%88%86%E6%AE%B5%E4%B8%8B%E8%BD%BD" class="">大文件分段下载</a></div><div class="main-toc--li3"><a href="#%E4%B8%8B%E8%BD%BD%E5%88%86%E6%AE%B5%E6%96%87%E4%BB%B6%E5%88%B0%E6%9C%AC%E5%9C%B0%EF%BC%8C%E5%86%8D%E5%90%88%E5%B9%B6%E6%88%90%E4%B8%80%E4%B8%AA%E5%A4%A7%E6%96%87%E4%BB%B6" class="">下载分段文件到本地，再合并成一个大文件</a></div><div class="main-toc--li4"><a href="#%E5%A4%9A%E4%B8%AA%E5%B0%8F%E6%96%87%E4%BB%B6%E5%90%88%E5%B9%B6%E6%88%90%E4%B8%80%E4%B8%AA%E5%A4%A7%E6%96%87%E4%BB%B6" class="">多个小文件合并成一个大文件</a></div><div class="main-toc--li2"><a href="#Stream%20%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" class="">Stream 内存泄漏注意事项</a></div><div class="main-toc--li3"><a href="#%E6%89%8B%E5%8A%A8%E5%A4%84%E7%90%86%20Stream%20%E5%85%B3%E9%97%AD" class="">手动处理 Stream 关闭</a></div></div><p>流（Stream）是 Node.js 中处理流数据的抽象接口。流模块提供用于实现流接口的 API。Node.js 中有许多流对象事例，比如：<a href="https://nodejs.org/dist/latest-v15.x/docs/api/http.html#http_class_http_incomingmessage">HTTP Request</a>、<a href="https://nodejs.org/dist/latest-v15.x/docs/api/process.html#process_process_stdout">process.stdout</a></p><h2 id="Stream%20%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD" class="heading"><span>Stream 大文件下载</span><a name="Stream 大文件下载" href="#Stream%20%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD" class="anchor">#</a></h2><p>node 处理大文件下载的方式是创建一个 read stream 和一个 write stream 通过管道（pipe）的形式进行文件的下载。</p><div class="pre"><div class="playground show"><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" disabled="" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">//  fs.createReadStream(sourcePath).pipe(fs.createWriteStream(targetPath));
const fs = require(&#x27;fs&#x27;);
const request = require(&#x27;request&#x27;);

const sourcePath = &#x27;xx/xxx.txt&#x27;;
const targetPath = &#x27;xx/xxx.txt&#x27;;
const writeStream = fs.createWriteStream(targetPath)

request(sourcePath).pipe(writeStream);</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token comment" style="color:hsl(30, 20%, 50%)">//  fs.createReadStream(sourcePath).pipe(fs.createWriteStream(targetPath));</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> fs </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;fs&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> request </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;request&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> sourcePath </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;xx/xxx.txt&#x27;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> targetPath </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;xx/xxx.txt&#x27;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> writeStream </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> fs</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">createWriteStream</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">targetPath</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token function">request</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">sourcePath</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">pipe</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">writeStream</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><p>request 方法会读入二进制片段到缓存中，然后通过 write stream 尽快写入到磁盘</p><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:286px">
      <a class="gatsby-resp-image-link" href="/blog/static/30618abb0e677b636192f9fd1c22dbd3/1b92c/single-stream-download.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:356.64335664335664%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAABHCAYAAAAHk2dUAAAACXBIWXMAAAsSAAALEgHS3X78AAAE60lEQVRYw62YV2v0OhCG9///jdzkLpBchJBOekjvvffee6KPZ+A1s7K06+UcwSBblsdT3ily7e/vL2j46/f39yS9vb2Fz8/P0juaa/HC+fl52NzcDPv7++Hg4MBmT6zt7u7antfX15IgNb9wcnJim7+/v0Oz8fz8HFZWVkzqpIQ82NjYKF74+fkJv7+/xlwzqupeTLe2ttIMHx8fTR0xb29vD729vWFgYCB0dnaGwcHBsLCwEPr6+ooPw7whw729Pbv++voKi4uLZqft7W1Tjfny8jIcHR2F+/v7QgsxLzFkrK+vF4auMg4PD8Pp6Wk9Q3+Dqqurq+bp29vbcHNzY8S1p7u7O3MepPezsMHgfBWPM19cXJjtUJlr1o6Pj41pzKxgGDONB0xSpki9W0s9gJBU8MD7Dw8PhQZQvL9OQj3QRr0khkj49PRUYhgzLjklN5aWlswZuZGUEJDiiLOzM5NIdHV1FXp6egyXXGudfey/vr5O4xCV8Cbew5uAGOIaIPOi1pnFHOmTDIlLgbSVoehKSgjyGaiDBJIMyLCGHfE2Un58fFjo7ezs5BkSpwzsNTw8bIQZ+NDU1FSYmZkJ4+PjYW5uzqKJdwF8VmUxTMHIpzV/7cOvJKHsoZznsejxqVxJfiQjZRPs8vKyMcUuIiTAk2Qirv260lsW2MxIhwSQSgEfUTLwz6V+NvRyA9sq9BoliBLDmGQ/GJLRFcvxPv9+LVVb40G2yUmYLaM+ppEGBoAYAHd1dVld4VrPIK59GS0klCoMPIj3kApnQFQ21in0WuMaTwN875w6lWkzBNSqw1c9Y+jVBRo4AGkppS8vL0bqZaSFZuKd+lLCoTagCiFIQkDFjo6O0NbWFiYmJuxDxDFxPjY2VuRFqmJWQmyFNBgcpiQAch8v4SBmmJB11IbE4K6LZbUiVQaM4jakjiH2ABp8XZKJyIVaY0ZSYjtWt44hTtALIiXa2dnZorfx6z4TtVT1YACkmkVJ5ViOC30ujpPpKxX4SIhXG+3JNkupMTk5aUxbSg6CgmIVIgwBdH9/f5ifn7dixRrPMMPa2loBtToJdUN04EXAjRPIJJRQ9dda09GCj6hFKalMzLaSGNivOu6rYl2PTUryHRaDwjU0NGQ1WXVFHVlDYOcYTk9PW+cfd2BNGQILlcT/rLKYYkPCTw6AcAqpX84QySm+1y7Bhi/BFEnxODP3xDKnAz2DgA7JJNssNQI2jWWj80sW2HF/Ldtgq1TTHvc+lZMDdUN1uWksV0lf2EkSVm7amcEiL4roYPFod3e3OYVr1uLn2dAjGlAvPsWTIHS614xdkTzbtGOj/7VpJ1KEfN+76BTPcwBO7VEGgio17aOjo3aCp1EnGlBzZGTE4po1Eq72NmzaJSFSSTJsq7BjRmokrSSh+pRWRpYhdqFvwTGo40kpnw9qTWigDGQjBSmFM2aINZKA+mytaw/qtxwpSI0tW46UXCzHyaFyLMdHBC+hCn0zKZP5UJAAxAzqsv9JpOdx6ipJiIFp2P3RDEYAOT624WFAnwS2bmDW6DwSD3rE7N85fxr1fzviY23c4Fcq9EpnxDSNOnGMejTv3Ldc6FlDFXpoziHkPKAD6S8I3Zj/I5IMPTXhVQYOjHNhyctIQIySafiADj4i1kTsIfbpuxv++6IGKxnEpcCTSgD7PcN/wSBnq8J7RNkAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="single stream download image" title="single stream download image" src="/blog/static/30618abb0e677b636192f9fd1c22dbd3/1b92c/single-stream-download.png" srcSet="/blog/static/30618abb0e677b636192f9fd1c22dbd3/6a467/single-stream-download.png 210w,/blog/static/30618abb0e677b636192f9fd1c22dbd3/1b92c/single-stream-download.png 286w" sizes="(max-width: 286px) 100vw, 286px" loading="lazy"/>
  </a>
    </span></p><p>流式下载可以保证不占用过大的内存，保证大文件稳定下载。但是单个下载只会占用机器小部分资源，如何充分利用机器资源优化下载呢？如果多个大文件下载，并发下载可以保证资源占用，单个大文件下载则可以指定分段下载，通过并发执行分段下载任务来充分利用资源。</p><h2 id="%E5%A4%A7%E6%96%87%E4%BB%B6%E5%88%86%E6%AE%B5%E4%B8%8B%E8%BD%BD" class="heading"><span>大文件分段下载</span><a name="大文件分段下载" href="#%E5%A4%A7%E6%96%87%E4%BB%B6%E5%88%86%E6%AE%B5%E4%B8%8B%E8%BD%BD" class="anchor">#</a></h2><h3 id="%E4%B8%8B%E8%BD%BD%E5%88%86%E6%AE%B5%E6%96%87%E4%BB%B6%E5%88%B0%E6%9C%AC%E5%9C%B0%EF%BC%8C%E5%86%8D%E5%90%88%E5%B9%B6%E6%88%90%E4%B8%80%E4%B8%AA%E5%A4%A7%E6%96%87%E4%BB%B6" class="heading"><span>下载分段文件到本地，再合并成一个大文件</span><a name="下载分段文件到本地，再合并成一个大文件" href="#%E4%B8%8B%E8%BD%BD%E5%88%86%E6%AE%B5%E6%96%87%E4%BB%B6%E5%88%B0%E6%9C%AC%E5%9C%B0%EF%BC%8C%E5%86%8D%E5%90%88%E5%B9%B6%E6%88%90%E4%B8%80%E4%B8%AA%E5%A4%A7%E6%96%87%E4%BB%B6" class="anchor">#</a></h3><p>通过 Range 对大文件进行分段，然后并发下载分段到本地，然后通过 Stream 将多个文件合并成一个大文件</p><h4 id="%E5%A4%9A%E4%B8%AA%E5%B0%8F%E6%96%87%E4%BB%B6%E5%90%88%E5%B9%B6%E6%88%90%E4%B8%80%E4%B8%AA%E5%A4%A7%E6%96%87%E4%BB%B6" class="heading"><span>多个小文件合并成一个大文件</span><a name="多个小文件合并成一个大文件" href="#%E5%A4%9A%E4%B8%AA%E5%B0%8F%E6%96%87%E4%BB%B6%E5%90%88%E5%B9%B6%E6%88%90%E4%B8%80%E4%B8%AA%E5%A4%A7%E6%96%87%E4%BB%B6" class="anchor">#</a></h4><div class="pre"><div class="playground show"><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" disabled="" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">const fs = require(&#x27;fs&#x27;);
const path = require(&#x27;path&#x27;);

function streamTogether(sourcePath, targetPath) {
  const fragmentFiles = fs.readdirSync(path.resolve(__dirname, sourcePath));
  const writeStream = fs.createWriteStream(path.resolve(__dirname, targetPath));

  streamRecursive(fragmentFiles, writeStream);
}

function streamRecursive(fFiles, wStream) {
  if (!fFiles.length) {
    return wStream.end();
  }

  const curPath = fFiles.shift();
  const curFile = path.resolve(__dirname, curPath);
  const curReadStream = fs.createReadStream(curFile);

  curReadStream.pipe(wStream, { end: false });

  curReadStream.on(&#x27;end&#x27;, () =&gt; {
    streamRecursive(fFiles, wStream);
  });

  curReadStream.on(&#x27;error&#x27;, err =&gt; {
    console.error(&#x27;error:&#x27;, err);
    wStream.close();
  });
}</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> fs </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;fs&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> path </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;path&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token function">streamTogether</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">sourcePath</span><span class="token parameter punctuation" style="opacity:0.7">,</span><span class="token parameter"> targetPath</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> fragmentFiles </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> fs</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">readdirSync</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">path</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">resolve</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> sourcePath</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> writeStream </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> fs</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">createWriteStream</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">path</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">resolve</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> targetPath</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token function">streamRecursive</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">fragmentFiles</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> writeStream</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token function">streamRecursive</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">fFiles</span><span class="token parameter punctuation" style="opacity:0.7">,</span><span class="token parameter"> wStream</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">if</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token operator" style="color:hsl(40, 90%, 60%)">!</span><span class="token plain">fFiles</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">length</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> wStream</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">end</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> curPath </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> fFiles</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">shift</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> curFile </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> path</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">resolve</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> curPath</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> curReadStream </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> fs</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">createReadStream</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">curFile</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  curReadStream</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">pipe</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">wStream</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> end</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(350, 40%, 70%)">false</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  curReadStream</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">on</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;end&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token function">streamRecursive</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">fFiles</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> wStream</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  curReadStream</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">on</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;error&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token parameter">err</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    console</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">error</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;error:&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> err</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    wStream</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">close</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><h2 id="Stream%20%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" class="heading"><span>Stream 内存泄漏注意事项</span><a name="Stream 内存泄漏注意事项" href="#Stream%20%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" class="anchor">#</a></h2><p>默认情况读写流执行完成后，会自动关闭，不会有内存泄漏问题。但是可以通过配置设置不自动关闭。</p><h3 id="%E6%89%8B%E5%8A%A8%E5%A4%84%E7%90%86%20Stream%20%E5%85%B3%E9%97%AD" class="heading"><span>手动处理 Stream 关闭</span><a name="手动处理 Stream 关闭" href="#%E6%89%8B%E5%8A%A8%E5%A4%84%E7%90%86%20Stream%20%E5%85%B3%E9%97%AD" class="anchor">#</a></h3><div class="pre"><div class="playground show"><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" disabled="" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">readable.pipe(destination[, options])</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token plain">readable</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">pipe</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">destination</span><span class="token punctuation" style="opacity:0.7">[</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> options</span><span class="token punctuation" style="opacity:0.7">]</span><span class="token punctuation" style="opacity:0.7">)</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><p>options 的 end 属性：读取结束时终止写入流，默认值是 true。</p><p>设置写流为 false，在结束时手动关闭。</p><div class="pre"><div class="playground show"><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" disabled="" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">readable.pipe(writeable, {
  end: false,
});
readable.on(&#x27;end&#x27;, function() {
  writeable.end(&#x27;end&#x27;);
});</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token plain">readable</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">pipe</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">writeable</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  end</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(350, 40%, 70%)">false</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">readable</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">on</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;end&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  writeable</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">end</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;end&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><p>如果发生异常错误，写入目标流将不会关闭，除非 kill 进程。需要监听错误异常，手动关闭写流，防止内存泄漏。</p><div class="pre"><div class="playground show"><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" disabled="" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">readable.pipe(writeable, {
  end: false,
});
readable.on(&#x27;end&#x27;, function() {
  writeable.end(&#x27;end&#x27;);
});
readable.on(&#x27;error&#x27;, function() {
  console.error(&#x27;error:&#x27;, error);
  writeable.end(&#x27;end&#x27;);
});</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token plain">readable</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">pipe</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">writeable</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  end</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> </span><span class="token boolean" style="color:hsl(350, 40%, 70%)">false</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">readable</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">on</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;end&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  writeable</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">end</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;end&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">readable</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">on</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;error&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  console</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">error</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;error:&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> error</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  writeable</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">end</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;end&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><div class="prev-next-nav"><a class="prev-page" rel="prev" href="/blog/django_blog/">← <!-- -->Django 构建博客</a><a class="next-page" rel="next" href="/blog/ipv46-subnet/">表单验证：支持 IPV4、IPV6 带掩码<!-- --> →</a></div></main><footer>© <!-- -->2021<!-- -->, Github<!-- --> <a href="https://github.com/buildGoodWeb/blog">Blog</a></footer></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'undefined', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/node-stream-download/";window.webpackCompilationHash="fe4b98b4e443afde89a7";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-aede868c16b590a60b51.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-6de38224883efd50a1e7.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-ad0d66018576bc9befc8.js"],"component---src-templates-blog-list-template-js":["/component---src-templates-blog-list-template-js-7578d8b9e034657e7482.js"],"component---src-pages-404-js":["/component---src-pages-404-js-e51ad6aa676e3d86ad1a.js"]};/*]]>*/</script><script src="/blog/webpack-runtime-e7215cf539a6f354666c.js" async=""></script><script src="/blog/app-aede868c16b590a60b51.js" async=""></script><script src="/blog/commons-f3268c9d7cfa9cf83b38.js" async=""></script><script src="/blog/styles-50947f8f1e6f46efd725.js" async=""></script><script src="/blog/component---src-templates-blog-post-js-ad0d66018576bc9befc8.js" async=""></script></body></html>