<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/blog/commons.f933939570d27fef2133.css">.theme-light{background-color:#f4f5f5}.theme-dark,.theme-light{-webkit-transition:.5s;transition:.5s;min-height:100vh}.theme-dark{background-color:#181818}svg{display:inline-block;stroke-width:0;stroke:currentColor;fill:currentColor;pointer-events:none}.layout{margin:0 auto;max-width:56rem;padding:3rem 1.5rem}.theme-light .layout{color:#555}.theme-dark .layout{color:#fff}.layout header{display:flex;align-items:baseline;justify-content:space-between}.layout .toggle{line-height:1;display:inline-block;cursor:pointer}.layout .toggle:hover{color:#0078e7}.layout.post ul li{line-height:1.75}.layout.post img{border-radius:5px;position:absolute;top:0}@media (min-width:768px){.layout table td,.layout table th{padding:12px 24px}}@media (max-width:768px){.layout body{font-size:12px}.layout table td,.layout table th{padding:8px 4px;word-break:break-all}}.layout table{width:100%;margin:8px 0 16px}.layout table th{color:#5c6b77;font-weight:500;white-space:nowrap;background:rgba(0,0,0,.02);border:1px solid #ebedf0}.layout table td{text-align:left;border:1px solid #ebedf0}</style><style data-href="/blog/styles.2d5671466d9414184026.css">.node{cursor:pointer}.node circle{fill:#4682b4;stroke:#000}.link{fill:none;stroke:#ccc;stroke-width:1px}.playground{font-size:13px;border-radius:4px;padding:5px;color:#fff}.playground .container{width:100%;border:1px solid #ccc;margin-bottom:8px}.playground .item{border:1px dotted #ccc;margin:8px}.playground .margin4{margin-right:4px}.playground.show{background-color:#234361}.playground-error{background-color:#f24542;border-radius:4px}.playground-error pre{padding:15px;background-color:transparent;border:0;color:inherit}.playground-view{background-color:#fff;border-radius:3px;color:#66788a;margin:4px;padding:16px;border:1px solid #ccc;display:flex;justify-content:space-between}.playground-view>div{width:90%}.playground-view>button{opacity:0;align-self:flex-end;-webkit-transition:opacity .3s ease;transition:opacity .3s ease}.heading:hover .anchor,.playground-view:hover button{opacity:1}.heading .anchor{margin-left:8px;opacity:0;-webkit-transition:opacity .3s ease;transition:opacity .3s ease;text-decoration:none}.main-toc{position:fixed;right:.5rem;top:4rem;margin-top:25px;padding-left:15px}.main-toc>div{line-height:2;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.main-toc--li2{font-size:14px}.main-toc--li3{font-size:12px;padding-left:10px}.main-toc--li4{font-size:12px;padding-left:20px}.main-toc a{text-decoration:none}.theme-light .main-toc a{color:#555}.theme-dark .main-toc a{color:#fff}.main-toc a.current,.main-toc a:hover{color:#337ab7}@media (min-width:900px){.main-toc{width:12rem}}@media (max-width:900px){.main-toc{position:static}}.bio{display:flex;margin-bottom:2rem}.bio img{margin-bottom:0;margin-right:2rem;min-width:50px;border-radius:50%}

/*!
Pure v1.0.1
Copyright 2013 Yahoo!
Licensed under the BSD License.
https://github.com/pure-css/pure/blob/master/LICENSE.md
*/
/*!
normalize.css v^3.0 | MIT License | git.io/normalize
Copyright (c) Nicolas Gallagher and Jonathan Neal
*/
/*! normalize.css v3.0.3 | MIT License | github.com/necolas/normalize.css */html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background-color:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],input[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]{-webkit-appearance:textfield;box-sizing:content-box}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}.hidden,[hidden]{display:none!important}.pure-img{max-width:100%;height:auto;display:block}.pure-g{letter-spacing:-.31em;text-rendering:optimizespeed;font-family:FreeSans,Arimo,Droid Sans,Helvetica,Arial,sans-serif;display:flex;flex-flow:row wrap;align-content:flex-start}@media (-ms-high-contrast:active),(-ms-high-contrast:none){table .pure-g{display:block}}.opera-only :-o-prefocus,.pure-g{word-spacing:-.43em}.pure-u{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-g [class*=pure-u]{font-family:sans-serif}.pure-u-1,.pure-u-1-1,.pure-u-1-2,.pure-u-1-3,.pure-u-1-4,.pure-u-1-5,.pure-u-1-6,.pure-u-1-8,.pure-u-1-12,.pure-u-1-24,.pure-u-2-3,.pure-u-2-5,.pure-u-2-24,.pure-u-3-4,.pure-u-3-5,.pure-u-3-8,.pure-u-3-24,.pure-u-4-5,.pure-u-4-24,.pure-u-5-5,.pure-u-5-6,.pure-u-5-8,.pure-u-5-12,.pure-u-5-24,.pure-u-6-24,.pure-u-7-8,.pure-u-7-12,.pure-u-7-24,.pure-u-8-24,.pure-u-9-24,.pure-u-10-24,.pure-u-11-12,.pure-u-11-24,.pure-u-12-24,.pure-u-13-24,.pure-u-14-24,.pure-u-15-24,.pure-u-16-24,.pure-u-17-24,.pure-u-18-24,.pure-u-19-24,.pure-u-20-24,.pure-u-21-24,.pure-u-22-24,.pure-u-23-24,.pure-u-24-24{display:inline-block;zoom:1;letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-u-1-24{width:4.1667%}.pure-u-1-12,.pure-u-2-24{width:8.3333%}.pure-u-1-8,.pure-u-3-24{width:12.5%}.pure-u-1-6,.pure-u-4-24{width:16.6667%}.pure-u-1-5{width:20%}.pure-u-5-24{width:20.8333%}.pure-u-1-4,.pure-u-6-24{width:25%}.pure-u-7-24{width:29.1667%}.pure-u-1-3,.pure-u-8-24{width:33.3333%}.pure-u-3-8,.pure-u-9-24{width:37.5%}.pure-u-2-5{width:40%}.pure-u-5-12,.pure-u-10-24{width:41.6667%}.pure-u-11-24{width:45.8333%}.pure-u-1-2,.pure-u-12-24{width:50%}.pure-u-13-24{width:54.1667%}.pure-u-7-12,.pure-u-14-24{width:58.3333%}.pure-u-3-5{width:60%}.pure-u-5-8,.pure-u-15-24{width:62.5%}.pure-u-2-3,.pure-u-16-24{width:66.6667%}.pure-u-17-24{width:70.8333%}.pure-u-3-4,.pure-u-18-24{width:75%}.pure-u-19-24{width:79.1667%}.pure-u-4-5{width:80%}.pure-u-5-6,.pure-u-20-24{width:83.3333%}.pure-u-7-8,.pure-u-21-24{width:87.5%}.pure-u-11-12,.pure-u-22-24{width:91.6667%}.pure-u-23-24{width:95.8333%}.pure-u-1,.pure-u-1-1,.pure-u-5-5,.pure-u-24-24{width:100%}.pure-button{display:inline-block;zoom:1;line-height:normal;white-space:nowrap;vertical-align:middle;text-align:center;cursor:pointer;-webkit-user-drag:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;box-sizing:border-box}.pure-button::-moz-focus-inner{padding:0;border:0}.pure-button-group{letter-spacing:-.31em;text-rendering:optimizespeed}.opera-only :-o-prefocus,.pure-button-group{word-spacing:-.43em}.pure-button-group .pure-button{letter-spacing:normal;word-spacing:normal;vertical-align:top;text-rendering:auto}.pure-button{font-family:inherit;font-size:100%;padding:.5em 1em;color:#444;color:rgba(0,0,0,.8);border:transparent;background-color:#e6e6e6;text-decoration:none;border-radius:2px}.pure-button-hover,.pure-button:focus,.pure-button:hover{background-image:-webkit-gradient(linear,left top,left bottom,from(transparent),color-stop(40%,rgba(0,0,0,.05)),to(rgba(0,0,0,.1)));background-image:linear-gradient(transparent,rgba(0,0,0,.05) 40%,rgba(0,0,0,.1))}.pure-button:focus{outline:0}.pure-button-active,.pure-button:active{box-shadow:inset 0 0 0 1px rgba(0,0,0,.15),inset 0 0 6px rgba(0,0,0,.2);border-color:#000}.pure-button-disabled,.pure-button-disabled:active,.pure-button-disabled:focus,.pure-button-disabled:hover,.pure-button[disabled]{border:none;background-image:none;opacity:.4;cursor:not-allowed;box-shadow:none;pointer-events:none}.pure-button-hidden{display:none}.pure-button-primary,.pure-button-selected,a.pure-button-primary,a.pure-button-selected{background-color:#0078e7;color:#fff}.pure-button-group .pure-button{margin:0;border-radius:0;border-right:1px solid #111;border-right:1px solid rgba(0,0,0,.2)}.pure-button-group .pure-button:first-child{border-top-left-radius:2px;border-bottom-left-radius:2px}.pure-button-group .pure-button:last-child{border-top-right-radius:2px;border-bottom-right-radius:2px;border-right:none}.pure-form input[type=color],.pure-form input[type=date],.pure-form input[type=datetime-local],.pure-form input[type=datetime],.pure-form input[type=email],.pure-form input[type=month],.pure-form input[type=number],.pure-form input[type=password],.pure-form input[type=search],.pure-form input[type=tel],.pure-form input[type=text],.pure-form input[type=time],.pure-form input[type=url],.pure-form input[type=week],.pure-form select,.pure-form textarea{padding:.5em .6em;display:inline-block;border:1px solid #ccc;box-shadow:inset 0 1px 3px #ddd;border-radius:4px;vertical-align:middle;box-sizing:border-box}.pure-form input:not([type]){padding:.5em .6em;display:inline-block;border:1px solid #ccc;box-shadow:inset 0 1px 3px #ddd;border-radius:4px;box-sizing:border-box}.pure-form input[type=color]{padding:.2em .5em}.pure-form input:not([type]):focus,.pure-form input[type=color]:focus,.pure-form input[type=date]:focus,.pure-form input[type=datetime-local]:focus,.pure-form input[type=datetime]:focus,.pure-form input[type=email]:focus,.pure-form input[type=month]:focus,.pure-form input[type=number]:focus,.pure-form input[type=password]:focus,.pure-form input[type=search]:focus,.pure-form input[type=tel]:focus,.pure-form input[type=text]:focus,.pure-form input[type=time]:focus,.pure-form input[type=url]:focus,.pure-form input[type=week]:focus,.pure-form select:focus,.pure-form textarea:focus{outline:0;border-color:#129fea}.pure-form input[type=checkbox]:focus,.pure-form input[type=file]:focus,.pure-form input[type=radio]:focus{outline:thin solid #129fea;outline:1px auto #129fea}.pure-form .pure-checkbox,.pure-form .pure-radio{margin:.5em 0;display:block}.pure-form input:not([type])[disabled],.pure-form input[type=color][disabled],.pure-form input[type=date][disabled],.pure-form input[type=datetime-local][disabled],.pure-form input[type=datetime][disabled],.pure-form input[type=email][disabled],.pure-form input[type=month][disabled],.pure-form input[type=number][disabled],.pure-form input[type=password][disabled],.pure-form input[type=search][disabled],.pure-form input[type=tel][disabled],.pure-form input[type=text][disabled],.pure-form input[type=time][disabled],.pure-form input[type=url][disabled],.pure-form input[type=week][disabled],.pure-form select[disabled],.pure-form textarea[disabled]{cursor:not-allowed;background-color:#eaeded;color:#cad2d3}.pure-form input[readonly],.pure-form select[readonly],.pure-form textarea[readonly]{background-color:#eee;color:#777;border-color:#ccc}.pure-form input:focus:invalid,.pure-form select:focus:invalid,.pure-form textarea:focus:invalid{color:#b94a48;border-color:#e9322d}.pure-form input[type=checkbox]:focus:invalid:focus,.pure-form input[type=file]:focus:invalid:focus,.pure-form input[type=radio]:focus:invalid:focus{outline-color:#e9322d}.pure-form select{height:2.25em;border:1px solid #ccc;background-color:#fff}.pure-form select[multiple]{height:auto}.pure-form label{margin:.5em 0 .2em}.pure-form fieldset{margin:0;padding:.35em 0 .75em;border:0}.pure-form legend{display:block;width:100%;padding:.3em 0;margin-bottom:.3em;color:#333;border-bottom:1px solid #e5e5e5}.pure-form-stacked input:not([type]),.pure-form-stacked input[type=color],.pure-form-stacked input[type=date],.pure-form-stacked input[type=datetime-local],.pure-form-stacked input[type=datetime],.pure-form-stacked input[type=email],.pure-form-stacked input[type=file],.pure-form-stacked input[type=month],.pure-form-stacked input[type=number],.pure-form-stacked input[type=password],.pure-form-stacked input[type=search],.pure-form-stacked input[type=tel],.pure-form-stacked input[type=text],.pure-form-stacked input[type=time],.pure-form-stacked input[type=url],.pure-form-stacked input[type=week],.pure-form-stacked label,.pure-form-stacked select,.pure-form-stacked textarea{display:block;margin:.25em 0}.pure-form-aligned .pure-help-inline,.pure-form-aligned input,.pure-form-aligned select,.pure-form-aligned textarea,.pure-form-message-inline{display:inline-block;vertical-align:middle}.pure-form-aligned textarea{vertical-align:top}.pure-form-aligned .pure-control-group{margin-bottom:.5em}.pure-form-aligned .pure-control-group label{text-align:right;display:inline-block;vertical-align:middle;width:10em;margin:0 1em 0 0}.pure-form-aligned .pure-controls{margin:1.5em 0 0 11em}.pure-form .pure-input-rounded,.pure-form input.pure-input-rounded{border-radius:2em;padding:.5em 1em}.pure-form .pure-group fieldset{margin-bottom:10px}.pure-form .pure-group input,.pure-form .pure-group textarea{display:block;padding:10px;margin:0 0 -1px;border-radius:0;position:relative;top:-1px}.pure-form .pure-group input:focus,.pure-form .pure-group textarea:focus{z-index:3}.pure-form .pure-group input:first-child,.pure-form .pure-group textarea:first-child{top:1px;border-radius:4px 4px 0 0;margin:0}.pure-form .pure-group input:first-child:last-child,.pure-form .pure-group textarea:first-child:last-child{top:1px;border-radius:4px;margin:0}.pure-form .pure-group input:last-child,.pure-form .pure-group textarea:last-child{top:-2px;border-radius:0 0 4px 4px;margin:0}.pure-form .pure-group button{margin:.35em 0}.pure-form .pure-input-1{width:100%}.pure-form .pure-input-3-4{width:75%}.pure-form .pure-input-2-3{width:66%}.pure-form .pure-input-1-2{width:50%}.pure-form .pure-input-1-3{width:33%}.pure-form .pure-input-1-4{width:25%}.pure-form-message-inline,.pure-form .pure-help-inline{display:inline-block;padding-left:.3em;color:#666;vertical-align:middle;font-size:.875em}.pure-form-message{display:block;color:#666;font-size:.875em}@media only screen and (max-width:480px){.pure-form button[type=submit]{margin:.7em 0 0}.pure-form input:not([type]),.pure-form input[type=color],.pure-form input[type=date],.pure-form input[type=datetime-local],.pure-form input[type=datetime],.pure-form input[type=email],.pure-form input[type=month],.pure-form input[type=number],.pure-form input[type=password],.pure-form input[type=search],.pure-form input[type=tel],.pure-form input[type=text],.pure-form input[type=time],.pure-form input[type=url],.pure-form input[type=week],.pure-form label{margin-bottom:.3em;display:block}.pure-group input:not([type]),.pure-group input[type=color],.pure-group input[type=date],.pure-group input[type=datetime-local],.pure-group input[type=datetime],.pure-group input[type=email],.pure-group input[type=month],.pure-group input[type=number],.pure-group input[type=password],.pure-group input[type=search],.pure-group input[type=tel],.pure-group input[type=text],.pure-group input[type=time],.pure-group input[type=url],.pure-group input[type=week]{margin-bottom:0}.pure-form-aligned .pure-control-group label{margin-bottom:.3em;text-align:left;display:block;width:100%}.pure-form-aligned .pure-controls{margin:1.5em 0 0}.pure-form-message,.pure-form-message-inline,.pure-form .pure-help-inline{display:block;font-size:.75em;padding:.2em 0 .8em}}.pure-menu{box-sizing:border-box}.pure-menu-fixed{position:fixed;left:0;top:0;z-index:3}.pure-menu-item,.pure-menu-list{position:relative}.pure-menu-list{list-style:none;margin:0;padding:0}.pure-menu-item{padding:0;margin:0;height:100%}.pure-menu-heading,.pure-menu-link{display:block;text-decoration:none;white-space:nowrap}.pure-menu-horizontal{width:100%;white-space:nowrap}.pure-menu-horizontal .pure-menu-list{display:inline-block}.pure-menu-horizontal .pure-menu-heading,.pure-menu-horizontal .pure-menu-item,.pure-menu-horizontal .pure-menu-separator{display:inline-block;zoom:1;vertical-align:middle}.pure-menu-item .pure-menu-item{display:block}.pure-menu-children{display:none;position:absolute;left:100%;top:0;margin:0;padding:0;z-index:3}.pure-menu-horizontal .pure-menu-children{left:0;top:auto;width:inherit}.pure-menu-active>.pure-menu-children,.pure-menu-allow-hover:hover>.pure-menu-children{display:block;position:absolute}.pure-menu-has-children>.pure-menu-link:after{padding-left:.5em;content:"\25B8";font-size:small}.pure-menu-horizontal .pure-menu-has-children>.pure-menu-link:after{content:"\25BE"}.pure-menu-scrollable{overflow-y:scroll;overflow-x:hidden}.pure-menu-scrollable .pure-menu-list{display:block}.pure-menu-horizontal.pure-menu-scrollable .pure-menu-list{display:inline-block}.pure-menu-horizontal.pure-menu-scrollable{white-space:nowrap;overflow-y:hidden;overflow-x:auto;-webkit-overflow-scrolling:touch;padding:.5em 0}.pure-menu-horizontal .pure-menu-children .pure-menu-separator,.pure-menu-separator{background-color:#ccc;height:1px;margin:.3em 0}.pure-menu-horizontal .pure-menu-separator{width:1px;height:1.3em;margin:0 .3em}.pure-menu-horizontal .pure-menu-children .pure-menu-separator{display:block;width:auto}.pure-menu-heading{text-transform:uppercase;color:#565d64}.pure-menu-link{color:#777}.pure-menu-children{background-color:#fff}.pure-menu-disabled,.pure-menu-heading,.pure-menu-link{padding:.5em 1em}.pure-menu-disabled{opacity:.5}.pure-menu-disabled .pure-menu-link:hover{background-color:transparent}.pure-menu-active>.pure-menu-link,.pure-menu-link:focus,.pure-menu-link:hover{background-color:#eee}.pure-menu-selected>.pure-menu-link,.pure-menu-selected>.pure-menu-link:visited{color:#000}.pure-table{border-collapse:collapse;border-spacing:0;empty-cells:show;border:1px solid #cbcbcb}.pure-table caption{color:#000;font:italic 85%/1 arial,sans-serif;padding:1em 0;text-align:center}.pure-table td,.pure-table th{border-left:1px solid #cbcbcb;border-bottom-width:0;border-right-width:0;border-top-width:0;font-size:inherit;margin:0;overflow:visible;padding:.5em 1em}.pure-table thead{background-color:#e0e0e0;color:#000;text-align:left;vertical-align:bottom}.pure-table td{background-color:transparent}.pure-table-odd td,.pure-table-striped tr:nth-child(2n-1) td{background-color:#f2f2f2}.pure-table-bordered td{border-bottom:1px solid #cbcbcb}.pure-table-bordered tbody>tr:last-child>td{border-bottom-width:0}.pure-table-horizontal td,.pure-table-horizontal th{border-width:0 0 1px;border-bottom:1px solid #cbcbcb}.pure-table-horizontal tbody>tr:last-child>td{border-bottom-width:0}body,html{font-size:15px;font-family:Helvetica Neue,Helvetica,PingFang SC,Arial,Microsoft YaHei,"\5FAE\8F6F\96C5\9ED1"}.pre{border-radius:4px;margin-bottom:10px}a{color:#0078e7;text-decoration:none}a:hover{opacity:.9}code{font-size:87.5%;color:#e83e8c;word-break:break-word}details{margin:15px 0;cursor:pointer}details summary:focus,details summary:hover{color:#337ab7;outline:none}.post h2:before,.post h3:before{display:block;height:1rem;margin-top:-1rem;visibility:hidden;content:""}.post h1 span{font-size:14px;padding-left:10px;color:#bbb}.post h1 a{font-size:16px;padding-left:12px}h1{margin-top:8px;margin-bottom:20px;font-weight:500;font-size:30px}h2{font-size:24px;line-height:32px}h3{font-size:20px;line-height:28px}.prev-next-nav{overflow:hidden;font-size:14px;border-top:1px solid #ebedf0}.prev-next-nav .next-page,.prev-next-nav .prev-page{display:block;width:50%;height:72px;line-height:72px}.prev-next-nav .prev-page{float:left}.prev-next-nav .next-page{float:right;text-align:right}.all-header{margin-bottom:30px}.all-header h3 span{font-size:13px;padding-left:10px;color:#bbb}.theme-light .all-header p{color:#555}.theme-dark .all-header p{color:#fff}.pagination{display:flex;justify-content:space-between;border-top:1px solid #ebedf0;padding:20px 0}.pagination .pages a{border:1px solid #ebedf0;border-radius:3px;padding:5px 12px;margin:0 5px}.pagination .pages a[aria-current=page]{color:#fff;background:#007acc}blockquote{background-color:#ddd;margin-left:0;margin-right:0;padding:1px 16px;border-left:2px solid #568bec}</style><meta name="generator" content="Gatsby 2.16.3"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="shortcut icon" href="/blog/icons/icon-48x48.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="manifest" href="/blog/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/blog/icons/icon-48x48.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="72x72" href="/blog/icons/icon-72x72.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="96x96" href="/blog/icons/icon-96x96.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="144x144" href="/blog/icons/icon-144x144.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="192x192" href="/blog/icons/icon-192x192.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="256x256" href="/blog/icons/icon-256x256.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="384x384" href="/blog/icons/icon-384x384.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><link rel="apple-touch-icon" sizes="512x512" href="/blog/icons/icon-512x512.png?v=f83d32e52a1dc7cc76e8530ba2d262b6"/><title data-react-helmet="true">React 和 D3 实现簇布局 | Kailang Blog</title><meta data-react-helmet="true" name="description" content="使用 React 开发 cluster layout（簇布局） 结构的布局"/><meta data-react-helmet="true" property="og:title" content="React 和 D3 实现簇布局"/><meta data-react-helmet="true" property="og:description" content="使用 React 开发 cluster layout（簇布局） 结构的布局"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="kailang"/><meta data-react-helmet="true" name="twitter:title" content="React 和 D3 实现簇布局"/><meta data-react-helmet="true" name="twitter:description" content="使用 React 开发 cluster layout（簇布局） 结构的布局"/><link as="script" rel="preload" href="/blog/component---src-templates-blog-post-js-ad0d66018576bc9befc8.js"/><link as="script" rel="preload" href="/blog/styles-50947f8f1e6f46efd725.js"/><link as="script" rel="preload" href="/blog/commons-f3268c9d7cfa9cf83b38.js"/><link as="script" rel="preload" href="/blog/app-aede868c16b590a60b51.js"/><link as="script" rel="preload" href="/blog/webpack-runtime-e7215cf539a6f354666c.js"/><link as="fetch" rel="preload" href="/blog/page-data/d3-cluster-layout/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div class="theme-light"><div class="layout post"><header><h3><a href="/blog/">Kailang Blog</a></h3><div class="toggle"><svg viewBox="0 0 1024 1024" width="32" height="14"><path d="M556.8 979.2c-262.4 0-473.6-211.2-473.6-467.2s211.2-467.2 467.2-467.2c12.8 0 19.2 6.4 25.6 12.8 6.4 12.8 6.4 19.2 0 32-57.6 70.4-83.2 160-83.2 249.6 0 230.4 185.6 416 416 416h6.4c12.8 0 19.2 6.4 25.6 12.8 6.4 12.8 6.4 19.2 0 32a498.56 498.56 0 0 1-384 179.2z m-64-876.8c-198.4 32-352 204.8-352 409.6 0 230.4 185.6 416 416 416 108.8 0 211.2-44.8 288-121.6-236.8-25.6-416-230.4-416-467.2 0-89.6 25.6-166.4 64-236.8z" fill="" p-id="4160"></path><path d="M582.4 883.2c-192 0-352-134.4-384-320 0-6.4 6.4-12.8 12.8-19.2 6.4 0 12.8 6.4 19.2 12.8 32 172.8 179.2 294.4 352 294.4 6.4 0 12.8 6.4 12.8 12.8 0 12.8-6.4 19.2-12.8 19.2zM204.8 531.2c-6.4 0-12.8-6.4-12.8-12.8v-19.2c0-6.4 6.4-12.8 12.8-12.8s12.8 6.4 12.8 12.8v19.2c6.4 6.4 0 12.8-12.8 12.8z" fill="" p-id="4161"></path><path d="M620.8 307.2m-25.6 0a25.6 25.6 0 1 0 51.2 0 25.6 25.6 0 1 0-51.2 0Z" fill="" p-id="4162"></path><path d="M793.6 185.6m-25.6 0a25.6 25.6 0 1 0 51.2 0 25.6 25.6 0 1 0-51.2 0Z" fill="" p-id="4163"></path><path d="M736 416m-25.6 0a25.6 25.6 0 1 0 51.2 0 25.6 25.6 0 1 0-51.2 0Z" fill="" p-id="4164"></path></svg></div></header><main><h1>React 和 D3 实现簇布局<span>2019-03-29</span><a target="_blank" rel="noopener noreferrer" href="/blog/static/d3-cluster-layout-63e0274f91f1f2b1d212a8510d1d4f40.pdf" title="打开 d3-cluster-layout.pdf 文件">Θ</a></h1><div class="main-toc row"><div>目录</div><div class="main-toc--li2"><a href="#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86" class="">相关知识</a></div><div class="main-toc--li3"><a href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" class="">工作原理</a></div><div class="main-toc--li3"><a href="#%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0" class="">使用函数</a></div><div class="main-toc--li2"><a href="#%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84%E7%B0%87%E5%B8%83%E5%B1%80" class="">实现简单的簇布局</a></div><div class="main-toc--li2"><a href="#%E7%BB%98%E5%88%B6%E6%9B%B2%E7%BA%BF" class="">绘制曲线</a></div><div class="main-toc--li2"><a href="#%E6%A8%AA%E5%90%91%E6%8E%92%E5%88%97%E5%B9%B6%E8%A1%A5%E5%85%85%E6%96%87%E6%A1%88" class="">横向排列并补充文案</a></div><div class="main-toc--li2"><a href="#%E5%AE%9E%E7%8E%B0%E6%94%B6%E7%BC%A9" class="">实现收缩</a></div><div class="main-toc--li2"><a href="#%E5%8F%82%E8%80%83" class="">参考</a></div></div><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:840px">
      <a class="gatsby-resp-image-link" href="/blog/static/d4d545767c154857bc33e049adaa58be/3c632/cluster-layout.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:57.20279720279721%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAA40lEQVQoz5VSiwqDMAzs/3+jbxwitlrnC583U2gpddYtEKLBXO4uMnjiOA5T7bR7ZVkiCALkeY62bcHwEBrA7e37ruq6rliWBdu2qR7zAd0x1MP0XNc1iqLwM7SBKMZxRJZlaJrGsHHBDUN3+ze/6GOSplnZDDnnit3PHtKgz0MNrt+ZlBLTNBlGfd8raSRTS6MqTq9q+b54WlUVwjBEmqZKBaPGMAxmK5lMv0LXdQZwnudT0gslby6XpxkColQM/5XsXt4N9nQQDXoHcAt4t50sSJJEJfmtrbGvHMcxoiiCEAIf4/BhMy0k9PcAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="cluster layout" title="cluster layout" src="/blog/static/d4d545767c154857bc33e049adaa58be/04a72/cluster-layout.png" srcSet="/blog/static/d4d545767c154857bc33e049adaa58be/6a467/cluster-layout.png 210w,/blog/static/d4d545767c154857bc33e049adaa58be/635b1/cluster-layout.png 420w,/blog/static/d4d545767c154857bc33e049adaa58be/04a72/cluster-layout.png 840w,/blog/static/d4d545767c154857bc33e049adaa58be/c6d2c/cluster-layout.png 1260w,/blog/static/d4d545767c154857bc33e049adaa58be/3c632/cluster-layout.png 1430w" sizes="(max-width: 840px) 100vw, 840px" loading="lazy"/>
  </a>
    </span></p><h2 id="%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86" class="heading"><span>相关知识</span><a name="相关知识" href="#%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86" class="anchor">#</a></h2><h3 id="%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" class="heading"><span>工作原理</span><a name="工作原理" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" class="anchor">#</a></h3><p>使用的是 D3 cluster layout 中的 API，对简单的数据进行格式化，补充父级、子级、坐标位置（Automatic Graph Drawing 算法）等可用数据。同时，提供快捷函数拿到需要数据进行渲染绘图。渲染后的数据结构如下：</p><div class="pre"><div class="playground show"><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" disabled="" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">{
  children: Array, // 子级
  data: Object, // 自身数据
  depth: Number,
  height: Number,
  parent: Object, // 父级
  x: Number, // x 轴坐标
  y: Number, // y 轴坐标
}</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  children</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> Array</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// 子级</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  data</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> Object</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// 自身数据</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  depth</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> Number</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  height</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> Number</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  parent</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> Object</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// 父级</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  x</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> Number</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// x 轴坐标</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  y</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> Number</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// y 轴坐标</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><h3 id="%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0" class="heading"><span>使用函数</span><a name="使用函数" href="#%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0" class="anchor">#</a></h3><ul><li>d3.layout.cluster() 设置默认簇布局</li><li>d3.layout.hierarchy() 默认设置创建新的分层布局</li><li>root.descendants() 所有节点的数组</li><li>root.links() 表达父子关系的数组</li></ul><h2 id="%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84%E7%B0%87%E5%B8%83%E5%B1%80" class="heading"><span>实现简单的簇布局</span><a name="实现简单的簇布局" href="#%E5%AE%9E%E7%8E%B0%E7%AE%80%E5%8D%95%E7%9A%84%E7%B0%87%E5%B8%83%E5%B1%80" class="anchor">#</a></h2><p>依赖 <code>d3-hierarchy</code></p><div class="pre"><div class="playground show"><div class="playground-error"></div><div class="playground-view"><div><div class="Dendrogram"><svg width="450" height="500"><g transform="translate(0, 40)"><g class="links"><line class="link" x1="259.6153846153846" y1="0" x2="259.6153846153846" y2="116.66666666666669"></line><line class="link" x1="259.6153846153846" y1="116.66666666666669" x2="86.53846153846155" y2="233.33333333333337"></line><line class="link" x1="259.6153846153846" y1="116.66666666666669" x2="276.92307692307696" y2="233.33333333333337"></line><line class="link" x1="259.6153846153846" y1="116.66666666666669" x2="415.3846153846154" y2="233.33333333333337"></line><line class="link" x1="86.53846153846155" y1="233.33333333333337" x2="34.61538461538462" y2="350"></line><line class="link" x1="86.53846153846155" y1="233.33333333333337" x2="69.23076923076924" y2="350"></line><line class="link" x1="86.53846153846155" y1="233.33333333333337" x2="103.84615384615385" y2="350"></line><line class="link" x1="86.53846153846155" y1="233.33333333333337" x2="138.46153846153848" y2="350"></line><line class="link" x1="276.92307692307696" y1="233.33333333333337" x2="207.6923076923077" y2="350"></line><line class="link" x1="276.92307692307696" y1="233.33333333333337" x2="242.3076923076923" y2="350"></line><line class="link" x1="276.92307692307696" y1="233.33333333333337" x2="276.92307692307696" y2="350"></line><line class="link" x1="276.92307692307696" y1="233.33333333333337" x2="311.53846153846155" y2="350"></line><line class="link" x1="276.92307692307696" y1="233.33333333333337" x2="346.1538461538462" y2="350"></line><line class="link" x1="415.3846153846154" y1="233.33333333333337" x2="415.3846153846154" y2="350"></line></g><g class="nodes"><g class="node"><circle r="4" cx="259.6153846153846" cy="0"></circle></g><g class="node"><circle r="4" cx="259.6153846153846" cy="116.66666666666669"></circle></g><g class="node"><circle r="4" cx="86.53846153846155" cy="233.33333333333337"></circle></g><g class="node"><circle r="4" cx="276.92307692307696" cy="233.33333333333337"></circle></g><g class="node"><circle r="4" cx="415.3846153846154" cy="233.33333333333337"></circle></g><g class="node"><circle r="4" cx="34.61538461538462" cy="350"></circle></g><g class="node"><circle r="4" cx="69.23076923076924" cy="350"></circle></g><g class="node"><circle r="4" cx="103.84615384615385" cy="350"></circle></g><g class="node"><circle r="4" cx="138.46153846153848" cy="350"></circle></g><g class="node"><circle r="4" cx="207.6923076923077" cy="350"></circle></g><g class="node"><circle r="4" cx="242.3076923076923" cy="350"></circle></g><g class="node"><circle r="4" cx="276.92307692307696" cy="350"></circle></g><g class="node"><circle r="4" cx="311.53846153846155" cy="350"></circle></g><g class="node"><circle r="4" cx="346.1538461538462" cy="350"></circle></g><g class="node"><circle r="4" cx="415.3846153846154" cy="350"></circle></g></g></g></svg></div></div><button class="pure-button pure-button-primary">隐藏代码</button></div><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">&lt;ClusterLayout/&gt;</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag class-name" style="color:hsl(350, 40%, 70%)">ClusterLayout</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">/&gt;</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><div class="pre"><div class="playground show"><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" disabled="" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">import React from &#x27;react&#x27;;
import { hierarchy, cluster } from &#x27;d3-hierarchy&#x27;;
import data from &#x27;./datas&#x27;;
import &#x27;./style.scss&#x27;;

const width = 450;
const height = 500;

const clusterLayout = cluster().size([height - 50, width - 100]);
const root = hierarchy(data, function (d) {
  return d.children;
});
clusterLayout(root);

class ClusterLayout extends React.PureComponent {
  renderNodes = () =&gt; {
    return root.descendants().map((d, idx) =&gt; {
      return (
        &lt;g
          className=&quot;node&quot;
          key={`link_${idx}`}
        &gt;
          &lt;circle r=&quot;4&quot; cx={d.x} cy={d.y}/&gt;
        &lt;/g&gt;
      )
    });
  }
  renderLinks = () =&gt; {
    return root.links().map((d, idx) =&gt; {
      return (
        &lt;line
          className=&quot;link&quot;
          key={`link_${idx}`}
          x1={d.source.x}
          y1={d.source.y}
          x2={d.target.x}
          y2={d.target.y}
        /&gt;
      )
    });
  }
  renderSvg = () =&gt; {
    return (
      &lt;svg width={width} height={height}&gt;
        &lt;g transform=&quot;translate(0, 40)&quot;&gt;
          &lt;g className=&quot;links&quot;&gt;
            {this.renderLinks()}
          &lt;/g&gt;
          &lt;g className=&quot;nodes&quot;&gt;
            {this.renderNodes()}
          &lt;/g&gt;
        &lt;/g&gt;
      &lt;/svg&gt;
    )
  }
  render() {
    return (
      &lt;div className=&quot;Dendrogram&quot;&gt;
        {this.renderSvg()}
      &lt;/div&gt;
    )
  }
}

export default ClusterLayout;</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token keyword" style="color:hsl(350, 40%, 70%)">import</span><span class="token plain"> React </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;react&#x27;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">import</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> hierarchy</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> cluster </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;d3-hierarchy&#x27;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">import</span><span class="token plain"> data </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;./datas&#x27;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">import</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;./style.scss&#x27;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> width </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">450</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> height </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">500</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> clusterLayout </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token function">cluster</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">size</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">[</span><span class="token plain">height </span><span class="token operator" style="color:hsl(40, 90%, 60%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">50</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> width </span><span class="token operator" style="color:hsl(40, 90%, 60%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">100</span><span class="token punctuation" style="opacity:0.7">]</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> root </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token function">hierarchy</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">data</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token function">clusterLayout</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">root</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">class</span><span class="token plain"> </span><span class="token class-name">ClusterLayout</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">extends</span><span class="token plain"> </span><span class="token class-name">React</span><span class="token class-name punctuation" style="opacity:0.7">.</span><span class="token class-name">PureComponent</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token function-variable function">renderNodes</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> root</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">descendants</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">map</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token parameter punctuation" style="opacity:0.7">,</span><span class="token parameter"> idx</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">          </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">className</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">node</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">          </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">`link_</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">${</span><span class="token tag script language-javascript template-string interpolation" style="color:hsl(350, 40%, 70%)">idx</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">`</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">circle</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">r</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">4</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">cx</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">d</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">x</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">cy</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">d</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">y</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;/</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token function-variable function">renderLinks</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> root</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">links</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">map</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token parameter punctuation" style="opacity:0.7">,</span><span class="token parameter"> idx</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">line</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">          </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">className</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">link</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">          </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">`link_</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">${</span><span class="token tag script language-javascript template-string interpolation" style="color:hsl(350, 40%, 70%)">idx</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">`</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">          </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">x1</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">d</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">source</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">x</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">          </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">y1</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">d</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">source</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">y</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">          </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">x2</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">d</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">target</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">x</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">          </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">y2</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">d</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">target</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">y</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token function-variable function">renderSvg</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">svg</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">width</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">width</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">height</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">height</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">transform</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">translate(0, 40)</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">className</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">links</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">            </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token keyword" style="color:hsl(350, 40%, 70%)">this</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">renderLinks</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;/</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">className</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">nodes</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">            </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token keyword" style="color:hsl(350, 40%, 70%)">this</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">renderNodes</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;/</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;/</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;/</span><span class="token tag" style="color:hsl(350, 40%, 70%)">svg</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token function">render</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">div</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">className</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">Dendrogram</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token keyword" style="color:hsl(350, 40%, 70%)">this</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">renderSvg</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;/</span><span class="token tag" style="color:hsl(350, 40%, 70%)">div</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">default</span><span class="token plain"> ClusterLayout</span><span class="token punctuation" style="opacity:0.7">;</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><h2 id="%E7%BB%98%E5%88%B6%E6%9B%B2%E7%BA%BF" class="heading"><span>绘制曲线</span><a name="绘制曲线" href="#%E7%BB%98%E5%88%B6%E6%9B%B2%E7%BA%BF" class="anchor">#</a></h2><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:840px">
      <a class="gatsby-resp-image-link" href="/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/37948/path.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:86.63594470046083%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQ4y61TYY+DIAzl///Ju2R3iW5MUbdFKdCjCKQizn04ElNoH4/X1go8Wc65YK21eGlkPidbLvEpIVmtIe//hZBUvlN3SsiVkDXGbPw1YvGJMuatPnRKWAOTuuu9z2kf4cQZWUrVGIvdMCEAhHMNtyM8IuMKUrpH9RRlPco0y3NKmSzvevpEqa52mf/cqTElJteQq1q0DoCSjBPO87JLnfx0NygMgQj4/m1xWfRhTYns66epxi7NDTWYlZAW+Jeog2Wa3FIcQPvPsNi2/oJ3c70A1R+XHkrxhOHx1MCg0MbXDVNZdn6NmR1mR5hHKg6/czbsy86T38V42m9qHdMXz9eM7V3htVM4TE+8dQN2avRT8Qhg5X2yH7xfhX3rx0/2I6pxwkb2YYLWpkjfFMA/Ms5C/lv0iREAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="cluster layout with path" title="cluster layout with path" src="/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/04a72/path.png" srcSet="/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/6a467/path.png 210w,/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/635b1/path.png 420w,/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/04a72/path.png 840w,/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/37948/path.png 868w" sizes="(max-width: 840px) 100vw, 840px" loading="lazy"/>
  </a>
    </span></p><p>绘制曲线链接需要将 line 改为更加灵活的 path 进行绘图。改动细节：</p><div class="pre"><div class="playground show"><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" disabled="" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">// 格式化
function formatPath(d) {
  const averageX = (d.source.x + d.target.x) / 2;
  return `M ${d.source.x}, ${d.source.y}
    C ${averageX}, ${d.source.y} ${averageX}, ${d.target.y} ${d.target.x}, ${d.target.y}`;
}
// 使用 path
renderLinks = () =&gt; {
  return root.links().map((d, idx) =&gt; {
    return (
      &lt;path
        className=&quot;link&quot;
        d={formatPath(d)}
        key={`link_${idx}`}
      /&gt;
    )
  });
}</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token comment" style="color:hsl(30, 20%, 50%)">// 格式化</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token function">formatPath</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> averageX </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">source</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">x </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">target</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">x</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">2</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">`M </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">source</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">source</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">y</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token template-string string" style="color:hsl(40, 90%, 60%)">    C </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">averageX</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">source</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">y</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)"> </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">averageX</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">target</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">y</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)"> </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">target</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">target</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">y</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">`</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token comment" style="color:hsl(30, 20%, 50%)">// 使用 path</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token function-variable function">renderLinks</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> root</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">links</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">map</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token parameter punctuation" style="opacity:0.7">,</span><span class="token parameter"> idx</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">path</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">        </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">className</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">link</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">        </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">d</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript function" style="color:hsl(350, 40%, 70%)">formatPath</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">(</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">d</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">)</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">        </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">`link_</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">${</span><span class="token tag script language-javascript template-string interpolation" style="color:hsl(350, 40%, 70%)">idx</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">`</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><h2 id="%E6%A8%AA%E5%90%91%E6%8E%92%E5%88%97%E5%B9%B6%E8%A1%A5%E5%85%85%E6%96%87%E6%A1%88" class="heading"><span>横向排列并补充文案</span><a name="横向排列并补充文案" href="#%E6%A8%AA%E5%90%91%E6%8E%92%E5%88%97%E5%B9%B6%E8%A1%A5%E5%85%85%E6%96%87%E6%A1%88" class="anchor">#</a></h2><p><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:840px">
      <a class="gatsby-resp-image-link" href="/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/386eb/row.png" style="display:block" target="_blank" rel="noopener">
    <span class="gatsby-resp-image-background-image" style="padding-bottom:97.01149425287356%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAB2UlEQVQ4y5VUi3KiQBDk/z/sUvE0QQ2IiAgCihhPLeSp0DezhgSJRDJV1Mpa9PZ0946EDlWW5edaf7iy/AxFnUDTNNi2DekRUB3s239FgSTNMFY1GMYMQRA8Bqyvl8sFYRjicDggyzKxd4pi6PMFVisP87nZDthsk8v2fPT6A4xGQ8RxLPaY4XxhCXbL5bI7Q2ZX1Nrmd96PkxS6YcJ1HViW9TPDCrAoCIz0qu/zO69RnOBFHmFKpqiq+jPDOrs2l9Msx/u/A/b7PY7H433AW3bFN3ZNSeolNU9smiG0qwE2gVlDefwGYza7o2FL5u5pd304hylMy4ZDDnueByk/n4XlSRLfgIWnCLvdDtvtFil91KwzfVe5PCWXmaGmTSEdwxP+PPex8X1xetXi61iFLMvCOT5QhJgOMU1TMGFAfAAaFGzHcbBerx+7XC9n5ePv4IUCbH/m8ESxUTRdtOy67tWUW13KG72q1pq65nkuGEbEkO+ybVvQ9dmXy23DoBmb6vBqP6U7bS0dBJsNfJJN6jJl2oN9bbn/OiRDJqTvottdrvTqUlLXWXhlWYoIRTRpeE2SRGSRRxn/5tH2q/FluSs8PfegKgqGQ2pzMkHwvsNTb0DxUmisjfAfnALJTcyESs0AAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <img class="gatsby-resp-image-image" alt="cluster layout with path and row" title="cluster layout with path and row" src="/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/04a72/row.png" srcSet="/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/6a467/row.png 210w,/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/635b1/row.png 420w,/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/04a72/row.png 840w,/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/386eb/row.png 870w" sizes="(max-width: 840px) 100vw, 840px" loading="lazy"/>
  </a>
    </span></p><ol><li>线条：要将 formatPath 函数的 x、y 对换</li><li>节点：transform 翻转，同时去掉 circle 的 cx、cy 属性</li></ol><div class="pre"><div class="playground show"><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" disabled="" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">// 线条 x、y 轴对换
function formatPath(d) {
  const averageY = (d.source.y + d.target.y) / 2;
  return `M ${d.source.y}, ${d.source.x}
    C ${averageY}, ${d.source.x} ${averageY}, ${d.target.x} ${d.target.y}, ${d.target.x}`;
}
// 节点翻转
renderNodes = () =&gt; {
  return root.descendants().map((d, idx) =&gt; {
    return (
      &lt;g
        transform={`translate(${d.y}, ${d.x})`}
        className=&quot;node&quot;
        key={`link_${idx}`}
      &gt;
        &lt;circle r=&quot;4&quot; /&gt;
        &lt;text&gt;{d.data.name}&lt;/text&gt;
      &lt;/g&gt;
    )
  });
}</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token comment" style="color:hsl(30, 20%, 50%)">// 线条 x、y 轴对换</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token function">formatPath</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> averageY </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">source</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">target</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">2</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">`M </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">source</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">y</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">source</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token template-string string" style="color:hsl(40, 90%, 60%)">    C </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">averageY</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">source</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)"> </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">averageY</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">target</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)"> </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">target</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">y</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">target</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">`</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token comment" style="color:hsl(30, 20%, 50%)">// 节点翻转</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token function-variable function">renderNodes</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> root</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">descendants</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">map</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token parameter punctuation" style="opacity:0.7">,</span><span class="token parameter"> idx</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">        </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">transform</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">`translate(</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">${</span><span class="token tag script language-javascript template-string interpolation" style="color:hsl(350, 40%, 70%)">d</span><span class="token tag script language-javascript template-string interpolation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript template-string interpolation" style="color:hsl(350, 40%, 70%)">y</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">${</span><span class="token tag script language-javascript template-string interpolation" style="color:hsl(350, 40%, 70%)">d</span><span class="token tag script language-javascript template-string interpolation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">.</span><span class="token tag script language-javascript template-string interpolation" style="color:hsl(350, 40%, 70%)">x</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">)`</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">        </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">className</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">node</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">        </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">key</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">`link_</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">${</span><span class="token tag script language-javascript template-string interpolation" style="color:hsl(350, 40%, 70%)">idx</span><span class="token tag script language-javascript template-string interpolation interpolation-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag script language-javascript template-string string" style="color:hsl(40, 90%, 60%)">`</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token tag" style="color:hsl(350, 40%, 70%)">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">circle</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">r</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">4</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">text</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain">d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">data</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">name</span><span class="token punctuation" style="opacity:0.7">}</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;/</span><span class="token tag" style="color:hsl(350, 40%, 70%)">text</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;/</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><h2 id="%E5%AE%9E%E7%8E%B0%E6%94%B6%E7%BC%A9" class="heading"><span>实现收缩</span><a name="实现收缩" href="#%E5%AE%9E%E7%8E%B0%E6%94%B6%E7%BC%A9" class="anchor">#</a></h2><div class="pre"><div class="playground show"><div class="playground-error"></div><div class="playground-view"><div><div class="CollapsibleTree"><svg width="600" height="400"><g transform="translate(50, 0)"></g></svg></div></div><button class="pure-button pure-button-primary">隐藏代码</button></div><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">CollapsibleTree</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token plain">CollapsibleTree</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><div class="pre"><div class="playground show"><div style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" disabled="" autoCapitalize="off" autoComplete="off" autoCorrect="off" spellcheck="false" data-gramm="false">import React from &#x27;react&#x27;;
import { hierarchy, cluster } from &#x27;d3-hierarchy&#x27;;
import { select } from &#x27;d3-selection&#x27;;
import datas from &#x27;./datas&#x27;;
import &#x27;./style.scss&#x27;

// Set the dimensions and margins of the diagram
const width = 700;
const height = 500;
const diameter = 10;
const distance = 160;

// Collapse the node and all it&#x27;s children
function collapse(d) {
  if (d.children) {
    d._children = d.children
    d._children.forEach(collapse)
    d.children = null
  }
}

// Creates a curved (diagonal) path from parent to the child nodes
function diagonal(s, d) {
  const averageY = (s.y + d.y) / 2;
  return `M ${s.y}, ${s.x}
    C ${averageY}, ${s.x} ${averageY}, ${d.x} ${d.y}, ${d.x}`;
}

const clusterLayout = cluster().size([height, width - 100]);
// Assigns parent, children, height, depth
const root = hierarchy(datas, function (d) { return d.children; });
root.x0 = height / 2;
root.y0 = 0;


class CollapsibleTree extends React.PureComponent {
  componentDidMount() {
    const svg = select(&#x27;.CollapsibleTree svg g&#x27;);
    let i = 0;

    // Collapse after the second level
    root.children.forEach(collapse);
    update(root);

    function update(source) {

      // Assigns the x and y position for the nodes
      const treeData = clusterLayout(root);

      // Compute the new tree layout.
      const nodes = treeData.descendants();
      const links = treeData.descendants().slice(1);

      nodes.forEach(function (d) { d.y = d.depth * distance });

      // Update the nodes...
      const node = svg.selectAll(&#x27;g.node&#x27;)
        .data(nodes, function (d) { return d.id || (d.id = ++i); });

      // Enter any new modes at the parent&#x27;s previous position.
      const nodeEnter = node.enter().append(&#x27;g&#x27;)
        .attr(&#x27;class&#x27;, &#x27;node&#x27;)
        .attr(&quot;transform&quot;, function (d) {
          return &quot;translate(&quot; + source.y0 + &quot;,&quot; + source.x0 + &quot;)&quot;;
        })
        .on(&#x27;click&#x27;, click);

      // Add Circle for the nodes
      nodeEnter.append(&#x27;circle&#x27;)
        .attr(&#x27;class&#x27;, &#x27;node&#x27;)
        .attr(&#x27;r&#x27;, diameter)
        .style(&quot;fill&quot;, function (d) {
          return d._children ? &quot;lightsteelblue&quot; : &quot;#fff&quot;;
        });

      // Add labels for the nodes
      nodeEnter.append(&#x27;text&#x27;)
        .attr(&quot;dy&quot;, 2)
        .attr(&quot;x&quot;, function (d) {
          return d.children || d._children ? -diameter : diameter;
        })
        .attr(&quot;text-anchor&quot;, function (d) {
          return d.children || d._children ? &quot;end&quot; : &quot;start&quot;;
        })
        .text(function (d) { return d.data.name; });

      // UPDATE
      const nodeUpdate = nodeEnter.merge(node);

      // Transition to the proper position for the node
      nodeUpdate
        .attr(&quot;transform&quot;, function (d) {
          return &quot;translate(&quot; + d.y + &quot;,&quot; + d.x + &quot;)&quot;;
        });

      // Update the node attributes and style
      nodeUpdate.select(&#x27;circle.node&#x27;)
        .attr(&#x27;r&#x27;, 10)
        .style(&quot;fill&quot;, function (d) {
          return d._children ? &quot;lightsteelblue&quot; : &quot;#fff&quot;;
        })
        .attr(&#x27;cursor&#x27;, &#x27;pointer&#x27;);


      // Remove any exiting nodes
     node.exit()
        .attr(&quot;transform&quot;, function (d) {
          return &quot;translate(&quot; + source.y + &quot;,&quot; + source.x + &quot;)&quot;;
        })
        .remove();

      // Update the links...
      const link = svg.selectAll(&#x27;path.link&#x27;)
        .data(links, function (d) { return d.id; });

      // Enter any new links at the parent&#x27;s previous position.
      const linkEnter = link.enter().insert(&#x27;path&#x27;, &quot;g&quot;)
        .attr(&quot;class&quot;, &quot;link&quot;)
        .attr(&#x27;d&#x27;, function (d) {
          const o = { x: source.x0, y: source.y0 }
          return diagonal(o, o)
        });

      // UPDATE
      const linkUpdate = linkEnter.merge(link);

      // Transition back to the parent element position
      linkUpdate
        .attr(&#x27;d&#x27;, function (d) { return diagonal(d, d.parent) });

      // Remove any exiting links
      link.exit()
        .attr(&#x27;d&#x27;, function (d) {
          const o = { x: source.x, y: source.y }
          return diagonal(o, o)
        })
        .remove();

      // Store the old positions for transition.
      nodes.forEach(function (d) {
        d.x0 = d.x;
        d.y0 = d.y;
      });

      // Toggle children on click.
      function click(d) {
        if (d.children) {
          d._children = d.children;
          d.children = null;
        } else {
          d.children = d._children;
          d._children = null;
        }
        update(d);
      }
    }
  }
  render() {
    return (
      &lt;div className=&quot;CollapsibleTree&quot;&gt;
        &lt;svg width={width} height={height}&gt;
          &lt;g transform=&quot;translate(50, 0)&quot;/&gt;
        &lt;/svg&gt;
      &lt;/div&gt;
    )
  }
}

export default CollapsibleTree;</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#C5C8C6"><span class="token keyword" style="color:hsl(350, 40%, 70%)">import</span><span class="token plain"> React </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;react&#x27;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">import</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> hierarchy</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> cluster </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;d3-hierarchy&#x27;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">import</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> select </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;d3-selection&#x27;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">import</span><span class="token plain"> datas </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">from</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;./datas&#x27;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">import</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;./style.scss&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Set the dimensions and margins of the diagram</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> width </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">700</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> height </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">500</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> diameter </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">10</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> distance </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">160</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Collapse the node and all it&#x27;s children</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token function">collapse</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">if</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">_children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children</span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">_children</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">forEach</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">collapse</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">null</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Creates a curved (diagonal) path from parent to the child nodes</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token function">diagonal</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">s</span><span class="token parameter punctuation" style="opacity:0.7">,</span><span class="token parameter"> d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> averageY </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">s</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">2</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">`M </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">s</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">y</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">s</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token template-string string" style="color:hsl(40, 90%, 60%)">    C </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">averageY</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">s</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)"> </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">averageY</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)"> </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">y</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">, </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">${</span><span class="token template-string interpolation">d</span><span class="token template-string interpolation punctuation" style="opacity:0.7">.</span><span class="token template-string interpolation">x</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="opacity:0.7">}</span><span class="token template-string string" style="color:hsl(40, 90%, 60%)">`</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> clusterLayout </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token function">cluster</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">size</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">[</span><span class="token plain">height</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> width </span><span class="token operator" style="color:hsl(40, 90%, 60%)">-</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">100</span><span class="token punctuation" style="opacity:0.7">]</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Assigns parent, children, height, depth</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> root </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token function">hierarchy</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">datas</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">root</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">x0 </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> height </span><span class="token operator" style="color:hsl(40, 90%, 60%)">/</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">2</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">root</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y0 </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">0</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">class</span><span class="token plain"> </span><span class="token class-name">CollapsibleTree</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">extends</span><span class="token plain"> </span><span class="token class-name">React</span><span class="token class-name punctuation" style="opacity:0.7">.</span><span class="token class-name">PureComponent</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token function">componentDidMount</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> svg </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token function">select</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;.CollapsibleTree svg g&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">let</span><span class="token plain"> i </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">0</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Collapse after the second level</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    root</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">forEach</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">collapse</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token function">update</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">root</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token function">update</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">source</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Assigns the x and y position for the nodes</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> treeData </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token function">clusterLayout</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">root</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Compute the new tree layout.</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> nodes </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> treeData</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">descendants</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> links </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> treeData</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">descendants</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">slice</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token number" style="color:hsl(350, 40%, 70%)">1</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      nodes</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">forEach</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">depth </span><span class="token operator" style="color:hsl(40, 90%, 60%)">*</span><span class="token plain"> distance </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Update the nodes...</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> node </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> svg</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">selectAll</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;g.node&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">data</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">nodes</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">id </span><span class="token operator" style="color:hsl(40, 90%, 60%)">||</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">id </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">++</span><span class="token plain">i</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Enter any new modes at the parent&#x27;s previous position.</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> nodeEnter </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> node</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">enter</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">append</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;g&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;class&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;node&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;transform&quot;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;translate(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> source</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y0 </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;,&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> source</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">x0 </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;)&quot;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">on</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;click&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> click</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Add Circle for the nodes</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      nodeEnter</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">append</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;circle&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;class&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;node&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;r&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> diameter</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">style</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;fill&quot;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">_children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">?</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;lightsteelblue&quot;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;#fff&quot;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Add labels for the nodes</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      nodeEnter</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">append</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;text&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;dy&quot;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">2</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;x&quot;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">||</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">_children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">?</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">-</span><span class="token plain">diameter </span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> diameter</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;text-anchor&quot;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">||</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">_children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">?</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;end&quot;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;start&quot;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">text</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">data</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">name</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// UPDATE</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> nodeUpdate </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> nodeEnter</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">merge</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">node</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Transition to the proper position for the node</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      nodeUpdate</span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;transform&quot;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;translate(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;,&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">x </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;)&quot;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Update the node attributes and style</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      nodeUpdate</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">select</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;circle.node&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;r&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token number" style="color:hsl(350, 40%, 70%)">10</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">style</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;fill&quot;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">_children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">?</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;lightsteelblue&quot;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;#fff&quot;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;cursor&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;pointer&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Remove any exiting nodes</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">     node</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">exit</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;transform&quot;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;translate(&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> source</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;,&quot;</span><span class="token plain"> </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> source</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">x </span><span class="token operator" style="color:hsl(40, 90%, 60%)">+</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;)&quot;</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">remove</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Update the links...</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> link </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> svg</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">selectAll</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;path.link&#x27;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">data</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">links</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">id</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Enter any new links at the parent&#x27;s previous position.</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> linkEnter </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> link</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">enter</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">insert</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;path&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;g&quot;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;class&quot;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token string" style="color:hsl(40, 90%, 60%)">&quot;link&quot;</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;d&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> o </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> x</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> source</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">x0</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> y</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> source</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y0 </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token function">diagonal</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">o</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> o</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// UPDATE</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> linkUpdate </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> linkEnter</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">merge</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">link</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Transition back to the parent element position</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      linkUpdate</span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;d&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token function">diagonal</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">d</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">parent</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Remove any exiting links</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      link</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">exit</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">attr</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token string" style="color:hsl(40, 90%, 60%)">&#x27;d&#x27;</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">const</span><span class="token plain"> o </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"> x</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> source</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">x</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> y</span><span class="token punctuation" style="opacity:0.7">:</span><span class="token plain"> source</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token function">diagonal</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">o</span><span class="token punctuation" style="opacity:0.7">,</span><span class="token plain"> o</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">remove</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Store the old positions for transition.</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      nodes</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token function">forEach</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">x0 </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">x</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y0 </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">y</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token comment" style="color:hsl(30, 20%, 50%)">// Toggle children on click.</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">function</span><span class="token plain"> </span><span class="token function">click</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token parameter">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">if</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">_children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">null</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">else</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">_children</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          d</span><span class="token punctuation" style="opacity:0.7">.</span><span class="token plain">_children </span><span class="token operator" style="color:hsl(40, 90%, 60%)">=</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">null</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token function">update</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain">d</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token punctuation" style="opacity:0.7">;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token function">render</span><span class="token punctuation" style="opacity:0.7">(</span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">{</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">return</span><span class="token plain"> </span><span class="token punctuation" style="opacity:0.7">(</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">div</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">className</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">CollapsibleTree</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">svg</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">width</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">width</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">height</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">{</span><span class="token tag script language-javascript" style="color:hsl(350, 40%, 70%)">height</span><span class="token tag script language-javascript punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">}</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">          </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;</span><span class="token tag" style="color:hsl(350, 40%, 70%)">g</span><span class="token tag" style="color:hsl(350, 40%, 70%)"> </span><span class="token tag attr-name" style="color:hsl(75, 70%, 60%)">transform</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">=</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag attr-value" style="color:hsl(350, 40%, 70%)">translate(50, 0)</span><span class="token tag attr-value punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&quot;</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">/&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">        </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;/</span><span class="token tag" style="color:hsl(350, 40%, 70%)">svg</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">      </span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&lt;/</span><span class="token tag" style="color:hsl(350, 40%, 70%)">div</span><span class="token tag punctuation" style="color:hsl(350, 40%, 70%);opacity:0.7">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">    </span><span class="token punctuation" style="opacity:0.7">)</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain">  </span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token punctuation" style="opacity:0.7">}</span><span class="token plain"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain" style="display:inline-block"></span></div><div class="token-line" style="color:#C5C8C6"><span class="token plain"></span><span class="token keyword" style="color:hsl(350, 40%, 70%)">export</span><span class="token plain"> </span><span class="token keyword" style="color:hsl(350, 40%, 70%)">default</span><span class="token plain"> CollapsibleTree</span><span class="token punctuation" style="opacity:0.7">;</span></div></pre><style type="text/css">
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div></div></div><h2 id="%E5%8F%82%E8%80%83" class="heading"><span>参考</span><a name="参考" href="#%E5%8F%82%E8%80%83" class="anchor">#</a></h2><ul><li>Automatic Graph Drawing 算法： <a href="https://reingold.co/tidier-drawings.pdf">tidier-drawings</a>, <a href="http://dirk.jivas.de/papers/buchheim02improving.pdf">buchheim improving</a></li><li><a href="https://github.com/d3/d3/wiki/%E7%B0%87%E5%B8%83%E5%B1%80">D3 Wiki 簇布局</a></li><li>实践：<a href="https://www.d3-graph-gallery.com/graph/dendrogram_basic.html">dendrogram_basic</a></li><li><a href="https://github.com/d3/d3-hierarchy">d3-hierarchy</a></li><li><a href="https://github.com/d3/d3-selection">d3-selection</a></li></ul><div class="prev-next-nav"><a class="prev-page" rel="prev" href="/blog/aws-s3-console/">← <!-- -->AWS S3 Console 使用体验</a><a class="next-page" rel="next" href="/blog/regx-look-around/">Regx look around<!-- --> →</a></div></main><footer>© <!-- -->2021<!-- -->, Github<!-- --> <a href="https://github.com/buildGoodWeb/blog">Blog</a></footer></div></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'undefined', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/d3-cluster-layout/";window.webpackCompilationHash="fe4b98b4e443afde89a7";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-aede868c16b590a60b51.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-6de38224883efd50a1e7.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-ad0d66018576bc9befc8.js"],"component---src-templates-blog-list-template-js":["/component---src-templates-blog-list-template-js-7578d8b9e034657e7482.js"],"component---src-pages-404-js":["/component---src-pages-404-js-e51ad6aa676e3d86ad1a.js"]};/*]]>*/</script><script src="/blog/webpack-runtime-e7215cf539a6f354666c.js" async=""></script><script src="/blog/app-aede868c16b590a60b51.js" async=""></script><script src="/blog/commons-f3268c9d7cfa9cf83b38.js" async=""></script><script src="/blog/styles-50947f8f1e6f46efd725.js" async=""></script><script src="/blog/component---src-templates-blog-post-js-ad0d66018576bc9befc8.js" async=""></script></body></html>