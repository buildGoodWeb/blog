{"componentChunkName":"component---src-templates-blog-post-js","path":"/d3-cluster-layout/","webpackCompilationHash":"fe4b98b4e443afde89a7","result":{"data":{"mdx":{"id":"272ab443-7d09-5b24-831a-98341aabce11","excerpt":"相关知识 工作原理 使用的是 D3 cluster layout 中的 API，对简单的数据进行格式化，补充父级、子级、坐标位置（Automatic Graph Drawing 算法）等可用数据。同时，提供快捷函数拿到需要数据进行渲染绘图。渲染后的数据结构如下： 使用函数 d3.layout.cluster…","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"React 和 D3 实现簇布局\",\n  \"date\": \"2019-03-29T00:00:00.000Z\",\n  \"tags\": \"React, Chart\",\n  \"description\": \"使用 React 开发 cluster layout（簇布局） 结构的布局\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"840px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/blog/static/d4d545767c154857bc33e049adaa58be/3c632/cluster-layout.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": [\"noopener\"]\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"57.20279720279721%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAA40lEQVQoz5VSiwqDMAzs/3+jbxwitlrnC583U2gpddYtEKLBXO4uMnjiOA5T7bR7ZVkiCALkeY62bcHwEBrA7e37ruq6rliWBdu2qR7zAd0x1MP0XNc1iqLwM7SBKMZxRJZlaJrGsHHBDUN3+ze/6GOSplnZDDnnit3PHtKgz0MNrt+ZlBLTNBlGfd8raSRTS6MqTq9q+b54WlUVwjBEmqZKBaPGMAxmK5lMv0LXdQZwnudT0gslby6XpxkColQM/5XsXt4N9nQQDXoHcAt4t50sSJJEJfmtrbGvHMcxoiiCEAIf4/BhMy0k9PcAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"cluster layout\",\n    \"title\": \"cluster layout\",\n    \"src\": \"/blog/static/d4d545767c154857bc33e049adaa58be/04a72/cluster-layout.png\",\n    \"srcSet\": [\"/blog/static/d4d545767c154857bc33e049adaa58be/6a467/cluster-layout.png 210w\", \"/blog/static/d4d545767c154857bc33e049adaa58be/635b1/cluster-layout.png 420w\", \"/blog/static/d4d545767c154857bc33e049adaa58be/04a72/cluster-layout.png 840w\", \"/blog/static/d4d545767c154857bc33e049adaa58be/c6d2c/cluster-layout.png 1260w\", \"/blog/static/d4d545767c154857bc33e049adaa58be/3c632/cluster-layout.png 1430w\"],\n    \"sizes\": \"(max-width: 840px) 100vw, 840px\",\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"h2\", null, \"\\u76F8\\u5173\\u77E5\\u8BC6\"), mdx(\"h3\", null, \"\\u5DE5\\u4F5C\\u539F\\u7406\"), mdx(\"p\", null, \"\\u4F7F\\u7528\\u7684\\u662F D3 cluster layout \\u4E2D\\u7684 API\\uFF0C\\u5BF9\\u7B80\\u5355\\u7684\\u6570\\u636E\\u8FDB\\u884C\\u683C\\u5F0F\\u5316\\uFF0C\\u8865\\u5145\\u7236\\u7EA7\\u3001\\u5B50\\u7EA7\\u3001\\u5750\\u6807\\u4F4D\\u7F6E\\uFF08Automatic Graph Drawing \\u7B97\\u6CD5\\uFF09\\u7B49\\u53EF\\u7528\\u6570\\u636E\\u3002\\u540C\\u65F6\\uFF0C\\u63D0\\u4F9B\\u5FEB\\u6377\\u51FD\\u6570\\u62FF\\u5230\\u9700\\u8981\\u6570\\u636E\\u8FDB\\u884C\\u6E32\\u67D3\\u7ED8\\u56FE\\u3002\\u6E32\\u67D3\\u540E\\u7684\\u6570\\u636E\\u7ED3\\u6784\\u5982\\u4E0B\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"{\\n  children: Array, // \\u5B50\\u7EA7\\n  data: Object, // \\u81EA\\u8EAB\\u6570\\u636E\\n  depth: Number,\\n  height: Number,\\n  parent: Object, // \\u7236\\u7EA7\\n  x: Number, // x \\u8F74\\u5750\\u6807\\n  y: Number, // y \\u8F74\\u5750\\u6807\\n}\\n\")), mdx(\"h3\", null, \"\\u4F7F\\u7528\\u51FD\\u6570\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"d3.layout.cluster() \\u8BBE\\u7F6E\\u9ED8\\u8BA4\\u7C07\\u5E03\\u5C40\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"d3.layout.hierarchy() \\u9ED8\\u8BA4\\u8BBE\\u7F6E\\u521B\\u5EFA\\u65B0\\u7684\\u5206\\u5C42\\u5E03\\u5C40\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"root.descendants() \\u6240\\u6709\\u8282\\u70B9\\u7684\\u6570\\u7EC4\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"root.links() \\u8868\\u8FBE\\u7236\\u5B50\\u5173\\u7CFB\\u7684\\u6570\\u7EC4\")), mdx(\"h2\", null, \"\\u5B9E\\u73B0\\u7B80\\u5355\\u7684\\u7C07\\u5E03\\u5C40\"), mdx(\"p\", null, \"\\u4F9D\\u8D56 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"d3-hierarchy\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\",\n    \"metastring\": \"run\",\n    \"run\": true\n  }), \"<ClusterLayout/>\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"import React from 'react';\\nimport { hierarchy, cluster } from 'd3-hierarchy';\\nimport data from './datas';\\nimport './style.scss';\\n\\nconst width = 450;\\nconst height = 500;\\n\\nconst clusterLayout = cluster().size([height - 50, width - 100]);\\nconst root = hierarchy(data, function (d) {\\n  return d.children;\\n});\\nclusterLayout(root);\\n\\nclass ClusterLayout extends React.PureComponent {\\n  renderNodes = () => {\\n    return root.descendants().map((d, idx) => {\\n      return (\\n        <g\\n          className=\\\"node\\\"\\n          key={`link_${idx}`}\\n        >\\n          <circle r=\\\"4\\\" cx={d.x} cy={d.y}/>\\n        </g>\\n      )\\n    });\\n  }\\n  renderLinks = () => {\\n    return root.links().map((d, idx) => {\\n      return (\\n        <line\\n          className=\\\"link\\\"\\n          key={`link_${idx}`}\\n          x1={d.source.x}\\n          y1={d.source.y}\\n          x2={d.target.x}\\n          y2={d.target.y}\\n        />\\n      )\\n    });\\n  }\\n  renderSvg = () => {\\n    return (\\n      <svg width={width} height={height}>\\n        <g transform=\\\"translate(0, 40)\\\">\\n          <g className=\\\"links\\\">\\n            {this.renderLinks()}\\n          </g>\\n          <g className=\\\"nodes\\\">\\n            {this.renderNodes()}\\n          </g>\\n        </g>\\n      </svg>\\n    )\\n  }\\n  render() {\\n    return (\\n      <div className=\\\"Dendrogram\\\">\\n        {this.renderSvg()}\\n      </div>\\n    )\\n  }\\n}\\n\\nexport default ClusterLayout;\\n\")), mdx(\"h2\", null, \"\\u7ED8\\u5236\\u66F2\\u7EBF\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"840px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/37948/path.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": [\"noopener\"]\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"86.63594470046083%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAABMUlEQVQ4y61TYY+DIAzl///Ju2R3iW5MUbdFKdCjCKQizn04ElNoH4/X1go8Wc65YK21eGlkPidbLvEpIVmtIe//hZBUvlN3SsiVkDXGbPw1YvGJMuatPnRKWAOTuuu9z2kf4cQZWUrVGIvdMCEAhHMNtyM8IuMKUrpH9RRlPco0y3NKmSzvevpEqa52mf/cqTElJteQq1q0DoCSjBPO87JLnfx0NygMgQj4/m1xWfRhTYns66epxi7NDTWYlZAW+Jeog2Wa3FIcQPvPsNi2/oJ3c70A1R+XHkrxhOHx1MCg0MbXDVNZdn6NmR1mR5hHKg6/czbsy86T38V42m9qHdMXz9eM7V3htVM4TE+8dQN2avRT8Qhg5X2yH7xfhX3rx0/2I6pxwkb2YYLWpkjfFMA/Ms5C/lv0iREAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"cluster layout with path\",\n    \"title\": \"cluster layout with path\",\n    \"src\": \"/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/04a72/path.png\",\n    \"srcSet\": [\"/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/6a467/path.png 210w\", \"/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/635b1/path.png 420w\", \"/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/04a72/path.png 840w\", \"/blog/static/7407c5106d0a3b7d9e5fd2eb58a57c34/37948/path.png 868w\"],\n    \"sizes\": \"(max-width: 840px) 100vw, 840px\",\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"\\u7ED8\\u5236\\u66F2\\u7EBF\\u94FE\\u63A5\\u9700\\u8981\\u5C06 line \\u6539\\u4E3A\\u66F4\\u52A0\\u7075\\u6D3B\\u7684 path \\u8FDB\\u884C\\u7ED8\\u56FE\\u3002\\u6539\\u52A8\\u7EC6\\u8282\\uFF1A\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"// \\u683C\\u5F0F\\u5316\\nfunction formatPath(d) {\\n  const averageX = (d.source.x + d.target.x) / 2;\\n  return `M ${d.source.x}, ${d.source.y}\\n    C ${averageX}, ${d.source.y} ${averageX}, ${d.target.y} ${d.target.x}, ${d.target.y}`;\\n}\\n// \\u4F7F\\u7528 path\\nrenderLinks = () => {\\n  return root.links().map((d, idx) => {\\n    return (\\n      <path\\n        className=\\\"link\\\"\\n        d={formatPath(d)}\\n        key={`link_${idx}`}\\n      />\\n    )\\n  });\\n}\\n\")), mdx(\"h2\", null, \"\\u6A2A\\u5411\\u6392\\u5217\\u5E76\\u8865\\u5145\\u6587\\u6848\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"840px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/386eb/row.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": [\"noopener\"]\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"97.01149425287356%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAAB2UlEQVQ4y5VUi3KiQBDk/z/sUvE0QQ2IiAgCihhPLeSp0DezhgSJRDJV1Mpa9PZ0946EDlWW5edaf7iy/AxFnUDTNNi2DekRUB3s239FgSTNMFY1GMYMQRA8Bqyvl8sFYRjicDggyzKxd4pi6PMFVisP87nZDthsk8v2fPT6A4xGQ8RxLPaY4XxhCXbL5bI7Q2ZX1Nrmd96PkxS6YcJ1HViW9TPDCrAoCIz0qu/zO69RnOBFHmFKpqiq+jPDOrs2l9Msx/u/A/b7PY7H433AW3bFN3ZNSeolNU9smiG0qwE2gVlDefwGYza7o2FL5u5pd304hylMy4ZDDnueByk/n4XlSRLfgIWnCLvdDtvtFil91KwzfVe5PCWXmaGmTSEdwxP+PPex8X1xetXi61iFLMvCOT5QhJgOMU1TMGFAfAAaFGzHcbBerx+7XC9n5ePv4IUCbH/m8ESxUTRdtOy67tWUW13KG72q1pq65nkuGEbEkO+ybVvQ9dmXy23DoBmb6vBqP6U7bS0dBJsNfJJN6jJl2oN9bbn/OiRDJqTvottdrvTqUlLXWXhlWYoIRTRpeE2SRGSRRxn/5tH2q/FluSs8PfegKgqGQ2pzMkHwvsNTb0DxUmisjfAfnALJTcyESs0AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"cluster layout with path and row\",\n    \"title\": \"cluster layout with path and row\",\n    \"src\": \"/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/04a72/row.png\",\n    \"srcSet\": [\"/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/6a467/row.png 210w\", \"/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/635b1/row.png 420w\", \"/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/04a72/row.png 840w\", \"/blog/static/77c37bf859dd8a7d3c544aaa1dcaa9f9/386eb/row.png 870w\"],\n    \"sizes\": \"(max-width: 840px) 100vw, 840px\",\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u7EBF\\u6761\\uFF1A\\u8981\\u5C06 formatPath \\u51FD\\u6570\\u7684 x\\u3001y \\u5BF9\\u6362\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"\\u8282\\u70B9\\uFF1Atransform \\u7FFB\\u8F6C\\uFF0C\\u540C\\u65F6\\u53BB\\u6389 circle \\u7684 cx\\u3001cy \\u5C5E\\u6027\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"// \\u7EBF\\u6761 x\\u3001y \\u8F74\\u5BF9\\u6362\\nfunction formatPath(d) {\\n  const averageY = (d.source.y + d.target.y) / 2;\\n  return `M ${d.source.y}, ${d.source.x}\\n    C ${averageY}, ${d.source.x} ${averageY}, ${d.target.x} ${d.target.y}, ${d.target.x}`;\\n}\\n// \\u8282\\u70B9\\u7FFB\\u8F6C\\nrenderNodes = () => {\\n  return root.descendants().map((d, idx) => {\\n    return (\\n      <g\\n        transform={`translate(${d.y}, ${d.x})`}\\n        className=\\\"node\\\"\\n        key={`link_${idx}`}\\n      >\\n        <circle r=\\\"4\\\" />\\n        <text>{d.data.name}</text>\\n      </g>\\n    )\\n  });\\n}\\n\")), mdx(\"h2\", null, \"\\u5B9E\\u73B0\\u6536\\u7F29\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\",\n    \"metastring\": \"run\",\n    \"run\": true\n  }), \"CollapsibleTree\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"import React from 'react';\\nimport { hierarchy, cluster } from 'd3-hierarchy';\\nimport { select } from 'd3-selection';\\nimport datas from './datas';\\nimport './style.scss'\\n\\n// Set the dimensions and margins of the diagram\\nconst width = 700;\\nconst height = 500;\\nconst diameter = 10;\\nconst distance = 160;\\n\\n// Collapse the node and all it's children\\nfunction collapse(d) {\\n  if (d.children) {\\n    d._children = d.children\\n    d._children.forEach(collapse)\\n    d.children = null\\n  }\\n}\\n\\n// Creates a curved (diagonal) path from parent to the child nodes\\nfunction diagonal(s, d) {\\n  const averageY = (s.y + d.y) / 2;\\n  return `M ${s.y}, ${s.x}\\n    C ${averageY}, ${s.x} ${averageY}, ${d.x} ${d.y}, ${d.x}`;\\n}\\n\\nconst clusterLayout = cluster().size([height, width - 100]);\\n// Assigns parent, children, height, depth\\nconst root = hierarchy(datas, function (d) { return d.children; });\\nroot.x0 = height / 2;\\nroot.y0 = 0;\\n\\n\\nclass CollapsibleTree extends React.PureComponent {\\n  componentDidMount() {\\n    const svg = select('.CollapsibleTree svg g');\\n    let i = 0;\\n\\n    // Collapse after the second level\\n    root.children.forEach(collapse);\\n    update(root);\\n\\n    function update(source) {\\n\\n      // Assigns the x and y position for the nodes\\n      const treeData = clusterLayout(root);\\n\\n      // Compute the new tree layout.\\n      const nodes = treeData.descendants();\\n      const links = treeData.descendants().slice(1);\\n\\n      nodes.forEach(function (d) { d.y = d.depth * distance });\\n\\n      // Update the nodes...\\n      const node = svg.selectAll('g.node')\\n        .data(nodes, function (d) { return d.id || (d.id = ++i); });\\n\\n      // Enter any new modes at the parent's previous position.\\n      const nodeEnter = node.enter().append('g')\\n        .attr('class', 'node')\\n        .attr(\\\"transform\\\", function (d) {\\n          return \\\"translate(\\\" + source.y0 + \\\",\\\" + source.x0 + \\\")\\\";\\n        })\\n        .on('click', click);\\n\\n      // Add Circle for the nodes\\n      nodeEnter.append('circle')\\n        .attr('class', 'node')\\n        .attr('r', diameter)\\n        .style(\\\"fill\\\", function (d) {\\n          return d._children ? \\\"lightsteelblue\\\" : \\\"#fff\\\";\\n        });\\n\\n      // Add labels for the nodes\\n      nodeEnter.append('text')\\n        .attr(\\\"dy\\\", 2)\\n        .attr(\\\"x\\\", function (d) {\\n          return d.children || d._children ? -diameter : diameter;\\n        })\\n        .attr(\\\"text-anchor\\\", function (d) {\\n          return d.children || d._children ? \\\"end\\\" : \\\"start\\\";\\n        })\\n        .text(function (d) { return d.data.name; });\\n\\n      // UPDATE\\n      const nodeUpdate = nodeEnter.merge(node);\\n\\n      // Transition to the proper position for the node\\n      nodeUpdate\\n        .attr(\\\"transform\\\", function (d) {\\n          return \\\"translate(\\\" + d.y + \\\",\\\" + d.x + \\\")\\\";\\n        });\\n\\n      // Update the node attributes and style\\n      nodeUpdate.select('circle.node')\\n        .attr('r', 10)\\n        .style(\\\"fill\\\", function (d) {\\n          return d._children ? \\\"lightsteelblue\\\" : \\\"#fff\\\";\\n        })\\n        .attr('cursor', 'pointer');\\n\\n\\n      // Remove any exiting nodes\\n     node.exit()\\n        .attr(\\\"transform\\\", function (d) {\\n          return \\\"translate(\\\" + source.y + \\\",\\\" + source.x + \\\")\\\";\\n        })\\n        .remove();\\n\\n      // Update the links...\\n      const link = svg.selectAll('path.link')\\n        .data(links, function (d) { return d.id; });\\n\\n      // Enter any new links at the parent's previous position.\\n      const linkEnter = link.enter().insert('path', \\\"g\\\")\\n        .attr(\\\"class\\\", \\\"link\\\")\\n        .attr('d', function (d) {\\n          const o = { x: source.x0, y: source.y0 }\\n          return diagonal(o, o)\\n        });\\n\\n      // UPDATE\\n      const linkUpdate = linkEnter.merge(link);\\n\\n      // Transition back to the parent element position\\n      linkUpdate\\n        .attr('d', function (d) { return diagonal(d, d.parent) });\\n\\n      // Remove any exiting links\\n      link.exit()\\n        .attr('d', function (d) {\\n          const o = { x: source.x, y: source.y }\\n          return diagonal(o, o)\\n        })\\n        .remove();\\n\\n      // Store the old positions for transition.\\n      nodes.forEach(function (d) {\\n        d.x0 = d.x;\\n        d.y0 = d.y;\\n      });\\n\\n      // Toggle children on click.\\n      function click(d) {\\n        if (d.children) {\\n          d._children = d.children;\\n          d.children = null;\\n        } else {\\n          d.children = d._children;\\n          d._children = null;\\n        }\\n        update(d);\\n      }\\n    }\\n  }\\n  render() {\\n    return (\\n      <div className=\\\"CollapsibleTree\\\">\\n        <svg width={width} height={height}>\\n          <g transform=\\\"translate(50, 0)\\\"/>\\n        </svg>\\n      </div>\\n    )\\n  }\\n}\\n\\nexport default CollapsibleTree;\\n\")), mdx(\"h2\", null, \"\\u53C2\\u8003\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Automatic Graph Drawing \\u7B97\\u6CD5\\uFF1A \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://reingold.co/tidier-drawings.pdf\"\n  }), \"tidier-drawings\"), \", \", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"http://dirk.jivas.de/papers/buchheim02improving.pdf\"\n  }), \"buchheim improving\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/d3/d3/wiki/%E7%B0%87%E5%B8%83%E5%B1%80\"\n  }), \"D3 Wiki \\u7C07\\u5E03\\u5C40\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u5B9E\\u8DF5\\uFF1A\", mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://www.d3-graph-gallery.com/graph/dendrogram_basic.html\"\n  }), \"dendrogram_basic\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/d3/d3-hierarchy\"\n  }), \"d3-hierarchy\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/d3/d3-selection\"\n  }), \"d3-selection\"))));\n}\n;\nMDXContent.isMDXComponent = true;","headings":[{"value":"相关知识","depth":2},{"value":"工作原理","depth":3},{"value":"使用函数","depth":3},{"value":"实现简单的簇布局","depth":2},{"value":"绘制曲线","depth":2},{"value":"横向排列并补充文案","depth":2},{"value":"实现收缩","depth":2},{"value":"参考","depth":2}],"frontmatter":{"title":"React 和 D3 实现簇布局","date":"2019-03-29","description":"使用 React 开发 cluster layout（簇布局） 结构的布局"}},"file":{"relativePath":"d3-cluster-layout.pdf","publicURL":"/blog/static/d3-cluster-layout-63e0274f91f1f2b1d212a8510d1d4f40.pdf"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/d3-cluster-layout/","previous":{"fields":{"slug":"/aws-s3-console/"},"frontmatter":{"title":"AWS S3 Console 使用体验"}},"next":{"fields":{"slug":"/regx-look-around/"},"frontmatter":{"title":"Regx look around"}}}}}