{"componentChunkName":"component---src-templates-blog-post-js","path":"/electron-tray/","webpackCompilationHash":"fe4b98b4e443afde89a7","result":{"data":{"mdx":{"id":"0dd00767-de47-526a-a249-faaa0db2ef82","excerpt":"Electron 应用在执行一些长时间任务（比如上传、下载），我们想关闭界面后任务依旧执行。再次打开界面，依旧可以看到正在执行的任务以及任务进度。 托盘 可以帮我们实现这个功能。 创建托盘和菜单示例 实例化  Tray…","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Electron 应用处理长任务\",\n  \"date\": \"2020-11-26T00:00:00.000Z\",\n  \"tags\": \"electron, node\",\n  \"description\": \"通过 Electron 托盘（tray）实现后台执行长任务。\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Electron \\u5E94\\u7528\\u5728\\u6267\\u884C\\u4E00\\u4E9B\\u957F\\u65F6\\u95F4\\u4EFB\\u52A1\\uFF08\\u6BD4\\u5982\\u4E0A\\u4F20\\u3001\\u4E0B\\u8F7D\\uFF09\\uFF0C\\u6211\\u4EEC\\u60F3\\u5173\\u95ED\\u754C\\u9762\\u540E\\u4EFB\\u52A1\\u4F9D\\u65E7\\u6267\\u884C\\u3002\\u518D\\u6B21\\u6253\\u5F00\\u754C\\u9762\\uFF0C\\u4F9D\\u65E7\\u53EF\\u4EE5\\u770B\\u5230\\u6B63\\u5728\\u6267\\u884C\\u7684\\u4EFB\\u52A1\\u4EE5\\u53CA\\u4EFB\\u52A1\\u8FDB\\u5EA6\\u3002\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.electronjs.org/docs/api/tray\"\n  }), \"\\u6258\\u76D8\"), \"\\u53EF\\u4EE5\\u5E2E\\u6211\\u4EEC\\u5B9E\\u73B0\\u8FD9\\u4E2A\\u529F\\u80FD\\u3002\"), mdx(\"h2\", null, \"\\u521B\\u5EFA\\u6258\\u76D8\\u548C\\u83DC\\u5355\\u793A\\u4F8B\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u5B9E\\u4F8B\\u5316 \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Tray\"), \" \\u5E76\\u4F20\\u5165\\u56FE\\u6807\\u8DEF\\u5F84\\uFF1B\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u521B\\u5EFA\\u83DC\\u5355\\u5E76\\u914D\\u7F6E\\u5230\\u6258\\u76D8\\u4E2D\\u3002\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"const { app, Menu, Tray } = require('electron')\\n\\nlet tray = null;\\n// \\u7B49\\u540C app.on('read', () => { ... })\\napp.whenReady().then(() => {\\n  tray = new Tray('/path/to/my/icon')\\n  const contextMenu = Menu.buildFromTemplate([\\n    { label: 'Item1', type: 'radio' },\\n    { label: 'Item2', type: 'radio' },\\n    { label: 'Item3', type: 'radio', checked: true },\\n    { label: 'Item4', type: 'radio' }\\n  ])\\n  tray.setContextMenu(contextMenu)\\n})\\n\\n\")), mdx(\"h2\", null, \"\\u57FA\\u4E8E\\u6258\\u76D8\\u529F\\u80FD\\u5B9E\\u73B0\\u540E\\u53F0\\u8FD0\\u884C\\u5E94\\u7528\"), mdx(\"h3\", null, \"\\u5173\\u95ED\\u5E94\\u7528\\u524D\\u5524\\u9192\\u5BF9\\u8BDD\\u6846\\u4E8C\\u6B21\\u786E\\u8BA4\"), mdx(\"p\", null, \"\\u5173\\u95ED\\u5E94\\u7528\\u65F6\\uFF0C\\u89E6\\u53D1\\u5BF9\\u8BDD\\u6846\\uFF0C\\u53EF\\u652F\\u6301 3 \\u79CD\\u573A\\u666F\\uFF1A\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u70B9\\u51FB\\u300C\\u53D6\\u6D88\\u300D\\u53D6\\u6D88\\u5173\\u95ED\\u64CD\\u4F5C\\uFF1B\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u70B9\\u51FB\\u300C\\u9000\\u51FA\\u300D\\uFF0C\\u300C\\u540E\\u53F0\\u8FD0\\u884C\\u300D\\u9009\\u4E2D\\u65F6\\uFF0C\\u754C\\u9762\\u5173\\u95ED\\uFF0C\\u6258\\u76D8\\u4E0D\\u5173\\u95ED\\uFF0C\\u4EFB\\u52A1\\u7EE7\\u7EED\\u6267\\u884C\\uFF1B\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u70B9\\u51FB\\u300C\\u9000\\u51FA\\u300D\\uFF0C\\u300C\\u540E\\u53F0\\u8FD0\\u884C\\u300D\\u4E0D\\u9009\\u4E2D\\uFF0C\\u754C\\u9762\\u3001\\u6258\\u76D8\\u5173\\u95ED\\uFF0C\\u76F4\\u63A5\\u9000\\u51FA\\uFF0C\\u4EFB\\u52A1\\u7EC8\\u6B62\\u3002\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"mainWindow.on('close', (e) => {\\n  dialog.showMessageBox({\\n      title: '\\u9000\\u51FA',\\n      type: 'warning',\\n      icon: nativeImage.createFromPath(path.resolve(__dirname, 'icon.png')),\\n      message: `\\u786E\\u5B9A\\u8981\\u9000\\u51FA\\u5417\\uFF1F`,\\n      detail: '\\u9009\\u62E9\\u540E\\u53F0\\u8FD0\\u884C\\uFF0C\\u6B63\\u5728\\u8FD0\\u884C\\u7684\\u4EFB\\u52A1\\u5C06\\u5728\\u7CFB\\u7EDF\\u6258\\u76D8\\u4E2D\\u7EE7\\u7EED\\u8FD0\\u884C\\u3002',\\n      checkboxLabel: '\\u540E\\u53F0\\u8FD0\\u884C',\\n      checkboxChecked: true,\\n      buttons: btns,\\n      defaultId: process.platform == 'darwin' ? 0 : 1,\\n    }).then(dm => {\\n        if (process.platform == 'darwin') {\\n          switch (dm.response) {\\n            case 0:\\n              dm.response = 1;\\n              break;\\n            case 1:\\n              dm.response = 0;\\n              break;\\n            default:\\n              dm.response = 1;\\n            }\\n        }\\n  \\n        switch (dm.response) {\\n          case 1:\\n            if (dm.checkboxChecked) {\\n              if (mainWindow.isVisible()) {\\n                // \\u4FEE\\u590D\\u5168\\u5C4F hide \\u9ED1\\u5C4F\\u95EE\\u9898\\n                // https://github.com/electron/electron/issues/20263\\n                if (mainWindow.isFullScreen()) {\\n                  mainWindow.once('leave-full-screen', () => mainWindow.hide());\\n                  mainWindow.setFullScreen(false);\\n                } else {\\n                  mainWindow.hide();\\n                }\\n                e.preventDefault();\\n              }\\n            } else {\\n              app.exit(0);\\n            }\\n            break;\\n          default:\\n            e.preventDefault();\\n        }\\n      })\\n  e.preventDefault();\\n});\\n\")), mdx(\"p\", null, \"\\u6548\\u679C\\u5982\\u4E0B\\uFF1A\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"840px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/blog/static/31b519616bc4d001c75780c21bf50ddd/6d51e/electron-close-mac-dialog.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": [\"noopener\"]\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"46.93069306930693%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAACTUlEQVQoz22RWU8TYRSG55eZcIcENS4hGJZAQkBQYwRMjAsBMRHQKkG9QGO8EKIxoKlEAoJUKS2F7tuUtrQMbad0m5lSwCIXPA69VC+efCdv8r3nvOcIH20pPtkkPtviFYxrEsb1BDOOJLPOJHPuJN88KRZ0FnWWfCl++FMsB1KYgzIWUcYq7mDZyGMJ5xHem+O4/GE2o1E2IjHCkSixWJwtSWJrS6rU4XBE1/+Drkf1fz4xjMktYdvIIkyaQkTiCTStiKLEUdQCfn8As9mM1WpFFEWKRQ1VUVBV9R80TSUWl1h1hfBFZISpnz6iUh4tOUPOeYVsWkMM+HTDZZxOpz5FWG/gJxgM4vV6K/UJHo8Xp8tNIpHU02wzZZxj2DCO8HXFx+Z2gVzIgNs4ScR1zGoog9MTJBDwI8sy6XT6r1dGyabI7SQo76usr9upb2jjxs07CPOrAWL6rhS1RCZbJJ/LEU0UdG0bSdoik8lSKBQq8U4MC/kc6ayCOaDqx9DNIiXsdjetzW2crq5F+L4WRNLH3tst6vtQKGoaB3u7HJZ/US6X2dsrUSqVODr6XYl3WN4nrR7RN32AYbaMYf6YZYud2uoazp29gLDi2cRkcTC3ZNZZYd60gnF2gWdj4zx4+JixF694/vI1b96+Y2LiA6NPRxl6NMToyBBDgwOMPhlm8H4f3R1dDPTeQnCEZRbXRL6YHEzPWei9N0Jr520uN3Zx8XwTPd136b7eQ0dLOw11jVSdqqKu9gyXampoqa+no7GZzoYm+q9dpb+rnT8s2U/CgN2PbwAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"electron close mac dialog\",\n    \"title\": \"electron close mac dialog\",\n    \"src\": \"/blog/static/31b519616bc4d001c75780c21bf50ddd/04a72/electron-close-mac-dialog.png\",\n    \"srcSet\": [\"/blog/static/31b519616bc4d001c75780c21bf50ddd/6a467/electron-close-mac-dialog.png 210w\", \"/blog/static/31b519616bc4d001c75780c21bf50ddd/635b1/electron-close-mac-dialog.png 420w\", \"/blog/static/31b519616bc4d001c75780c21bf50ddd/04a72/electron-close-mac-dialog.png 840w\", \"/blog/static/31b519616bc4d001c75780c21bf50ddd/6d51e/electron-close-mac-dialog.png 1010w\"],\n    \"sizes\": \"(max-width: 840px) 100vw, 840px\",\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"818px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/blog/static/1d57a0431d0d9395e9d435dcd2dcb779/e198c/electron-close-win-dialog.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": [\"noopener\"]\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"61.12469437652812%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABYlAAAWJQFJUiTwAAACNUlEQVQoz42ST0/UUBTF56O5URMR/QIuTVzpyohIYkI0ceHGGDVEV34ACCxcGUM0rEwYkAEGGNppO3/a6XQ6baf/Xkvn52sRETZ4kpP3cm/eyTvn3trcdZv5GY25mRbzswrP7qinvKtUtRf3VHq6RxRPCPyAIDjlJJjg+z5RFFFiOp1WrM3d6LC+YqLrmnwQUmQFeZqTSSZRRhwKMpGRZReZ5zlhGGKaZnU/E60t3NZZ/mDyYzmna0W0Oj5KL8CwApJsylUYjUYIIc4FPz7p8X3NpPkzw+iMOFS6tNoWPdPFtkeVLc/zGI/Hf+lJuq5LfnKCe1kwnMTEyaQqDO0BHUPDHvSlfQ9d09ENA03XURT1lGobVVU5VhT5Lq2ELwiOHFf+wK8KuXToJmBOrrZaoig/4TgXBc2+JS14VSESOXYg6HtC2imuZjHFcS5ZHg6dKqcSaV7Qk2KqI/hfmKYlRV0pdmbZjmQOY05kwFkmVyXNCOOUNBWkiajOf9dFyH7Vkyzv9nDAlPSPfDmUIJUha2hGm929X7Tbqlxinzj1SYQ8RTnl8wnHiUealT1PWvY5ahrUNwKaW6nc24LaVEZrmR02vmzyba1Bo67wdeWATy+3eb9QZ2lxi9aBTq/Xpd/v8vldk9fzDd483+XtYoOF+zs8uKnx6uEA08io9Q8czKbFxuqA9WUPZSdkdcni6ewhj67t8/hWk5GVVnaKoqB9mLC3GdHcjtmvRxzvJhgtgXYkI0gKfgMBiXm+YsBhkAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"electron close window dialog\",\n    \"title\": \"electron close window dialog\",\n    \"src\": \"/blog/static/1d57a0431d0d9395e9d435dcd2dcb779/e198c/electron-close-win-dialog.png\",\n    \"srcSet\": [\"/blog/static/1d57a0431d0d9395e9d435dcd2dcb779/6a467/electron-close-win-dialog.png 210w\", \"/blog/static/1d57a0431d0d9395e9d435dcd2dcb779/635b1/electron-close-win-dialog.png 420w\", \"/blog/static/1d57a0431d0d9395e9d435dcd2dcb779/e198c/electron-close-win-dialog.png 818w\"],\n    \"sizes\": \"(max-width: 818px) 100vw, 818px\",\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"h3\", null, \"\\u521B\\u5EFA\\u6258\\u76D8\\u5E76\\u6DFB\\u52A0\\u83DC\\u5355\\u64CD\\u4F5C\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u7981\\u7528\\u53CC\\u51FB\\uFF08MacOS \\u7CFB\\u7EDF\\u4E0D\\u652F\\u6301\\u53CC\\u51FB\\u64CD\\u4F5C\\uFF09\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u83DC\\u5355\\u680F\\u652F\\u6301\\u64CD\\u4F5C\\uFF1A\\u5173\\u4E8E\\u4EA7\\u54C1\\u3001\\u663E\\u793A\\u3001\\u9000\\u51FA\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"MacOS \\u9ED8\\u8BA4\\u662F\\u5DE6\\u5355\\u51FB\\u6253\\u5F00\\u83DC\\u5355\\u680F\\u3001Windows \\u662F\\u53F3\\u5355\\u51FB\\u6253\\u5F00\\u83DC\\u5355\\u680F\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Windows \\u5DE6\\u5355\\u51FB\\u663E\\u793A\\u754C\\u9762\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"let tray = null;\\nconst createTray = () => {\\n    const trayIco = nativeImage.createFromPath(path.resolve(__dirname, 'tray_light.png'));\\n    tray = new Tray(trayIco);\\n    tray.setIgnoreDoubleClickEvents(true);\\n    if (process.platform !== 'darwin') {\\n      tray.on('click', () => {\\n        if (!mainWindow.isVisible()) {\\n          mainWindow.show();\\n        }\\n      });\\n    }\\n    const contextMenu = Menu.buildFromTemplate([\\n      {\\n        label: '\\u5173\\u4E8E\\u4EA7\\u54C1',\\n        role: 'about',\\n      },\\n      { type: 'separator' },\\n      { \\n        label: '\\u663E\\u793A',\\n        click: () => {\\n          if (!mainWindow.isVisible()) {\\n            mainWindow.show();\\n          }\\n        }\\n      },\\n      { type: 'separator' },\\n      {\\n        label: '\\u9000\\u51FA',\\n        click: e => {\\n          if (!mainWindow.isVisible()) {\\n            mainWindow.show();\\n          }\\n          confirmForWorkers(e);\\n        },\\n      },\\n    ]);\\n    tray.setContextMenu(contextMenu);\\n  }\\n\\n  createTray();\\n\")), mdx(\"h3\", null, \"\\u6839\\u636E\\u64CD\\u4F5C\\u7CFB\\u7EDF\\u7C7B\\u578B\\u548C\\u7CFB\\u7EDF Mode \\u5B9A\\u5236\\u6258\\u76D8\\u56FE\\u6807\"), mdx(\"p\", null, \"MacOS \\u652F\\u6301 light\\u3001dark \\u4E24\\u79CD mode\\uFF0C\\u6839\\u636E mode \\u5C55\\u793A\\u4E0D\\u540C\\u7684\\u56FE\\u6807\\uFF1A\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"276px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/blog/static/2692645e2f4d0348d421eadff15af3c3/3bcdc/electron-tray-mac-light.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": [\"noopener\"]\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"93.47826086956522%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAAECklEQVQ4y2WUS2wbVRSGZ8uGDTvWrLOFSsAGCQkJCYEqxAqEQCoLYEGpENBKqAgClUBAEUpp00QpbRKHxLET2/HEY8eZseP3Y162x3Zsxx7HbzsJXbD6OXPtJI1Y/Drjc+/9zn/Pvb5cqTVEkVTv9pG+8T0+evcO3px6Ga+/cBm/vf0lGj4eznAKLkFEpTXAQe8Yi+tuzC/b0Tn5F7XOCIejx4jJeUiJLDgLaLSO0GyaEL6bxXMfi3jm0gd46pWv8P6Hc0jN3oVdisMTCCGU1lBpD/HaW+9g6vmX8M2PP6PRP8YSFXj1jctYdnjAVdojlDrHaLVb2L3xC6Y+TeLZS1fw9Iuf4cp797G//BALngDWXNvw7kbQGJwgrhQY7JNrX6NQO2TFNraD2Dc74GxCCjYhiSV/Cr6b0/BcuwXH1W9h/3wa0evTKKVVZM0jJIsm9MYAujlE4fAIxfYJk1zpQK/3wUc1rAcS4P7ciOHeRhS/r4p4wMdRLB+gWGmiuF/HfZsTNpq0zIexIkTxyCNibt0H+04C8w4B6WoP8sGAac4RxKxDBPcooGLRr2LOHccin0C6PiKRo9oQt2ZtWHAKWPFFsOSV8JcrCH/awB+LTlz/aQbxYhNqYwSlPsCiN8LWc6vhElZDRTz0yVgJZJA96EOuD5GircRLh0iU2yymq102Vug8hqRVGThDDhWaawFXqG1rQRXcZrKBzWQdfxN0TdSQ3G8jSbBUpQuFqmdpOxkCZWo9pClvjVtghfqZrnZYYSvag1lsRkrgvEoHXqUNR6yGjYhx5lCmqkG5jEihgQRBEuUWQcZuxn3rs29LKsE3wzr4ZA3cttbHttbDZqIOV7Q0nmSOmL744TZ+XVjFHZuL9S3XOmbOVAI/KY1O3r2Xhy9TB+cjmCUXbd0VK40XNI+Y03urW5h3+uAUk3CFM2xMa46gmmPIqfTmEJ5IHgID6v0LQJnulEwL5cniMWAcLaDS6F+Qyhz3GdA/dtiHQEC3BYwWqflddgBWZE4mjixZuezB/yWT3Hs5+LMNcAJzSAk66a14iQC0BfonWIBlXsISL8IbU8mBTFfmZDI+OlNuoq1o/hTYYw495NACKqbVwxHb+s3bs5ieWcDMkpMOxfFE3wYXZPVwK1o4d+gnqDdtErDMqhrdf1jcyRp0gXMI56rYy1eRp1fJ6J7AoMfE6JzHfGtEuzAQkE1wgVwPOwQV6C56YmXwCYMG81QxB1+yiG0mg76tfA7eqH4mnuSL03WhNXxiH7taC1ww38Nu3oJ24acKbjoYp6RjXVRh31VIKn3rcFDOyaRhg3QaXSEqQkaCigkpR8+XWOiBKd+lRBuSfghRazJJVrR+k6SJQhNJ2rlCeova0kaYGP8BTf4D5Ng1dG8AAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"electron tray mac light\",\n    \"title\": \"electron tray mac light\",\n    \"src\": \"/blog/static/2692645e2f4d0348d421eadff15af3c3/3bcdc/electron-tray-mac-light.png\",\n    \"srcSet\": [\"/blog/static/2692645e2f4d0348d421eadff15af3c3/6a467/electron-tray-mac-light.png 210w\", \"/blog/static/2692645e2f4d0348d421eadff15af3c3/3bcdc/electron-tray-mac-light.png 276w\"],\n    \"sizes\": \"(max-width: 276px) 100vw, 276px\",\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \"), \"\\n\", mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"316px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/blog/static/4e3595865b2b933d6c2d4402413066c8/8594d/electron-tray-mac-dark.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": [\"noopener\"]\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"100%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAABYlAAAWJQFJUiTwAAAEJ0lEQVQ4y1WSeVNTVxiH8638o9aOtuN0xpEq6hTRVkSwQiCQsEgISxIkKxC2BBJDa2URgRaEsZBACCFhjWXJHuxMJbJk/Qy/vueQIM3MM+/Nufc+5/e+5wqu3noExjXi8p0n+On7m5DnyzA57MbMiAvVd9VoKSiEUK7HvSIhrty4jx7L79D2Wui6AFfzClEkrENtixrX6Fpw+UYhviauEJfyHuHhN9+hqGoGsl2gNwx8VenBsEQMUZsBUoWeBA/gWtsG+xlMv+LWw1/g3fWjy2jFpW9/gOB2sQT5xTW4Q9wsqUd54WMo86Uwd77H6545iPLkkD34GaUyDcpq5bh+7wmu3y2GQm/Ec2UH7j+VoFTSjB9LxCgoFUPwp/cI095jvPtwhFlizBmEtk6GF6VCtD+rwpCyHVKdGYqe39Dc+RJd1nGqVtS86EPpczWeSTVQ9o/AthPD4t5nCP7ypTHvT8MWSGPBn8JbVwgVKjNKlEaIdFbMe0OwvJnD8LQd5jezMA5PY8rmgc2zA5HcgHKZHhrzOBy+Y7jCSRLuJzHvS5GM6n4cYw4fJMoeVDR1oKatF4ruIUi1g6hTGSGhVE8btGjrfQXtwAiqFd0k1KHdNAr7ziFWggkIWCpbIAU7YfMlMO70o0FnQZ2GJOpBCFsMqG7rJ/pQqzLRPTO12w8J/W+gjWrb+6GzTJAwhpUQJbT5mSyNxWAadtayMwAxJRO2dKFK3g3TyAyfn8r4mieszK7nEDbpoaKES7sxrHIhyezBDBcuUsqJlQDfvby5kxIZsRf5F6OzS3i/vI4WOhRhcweJDBC1Gi4Ix+A4F3JZBkvnwiAXVlASVtWmEbQahtBIrYpptmeiM9gMmVBNCZf3YnAzYa5dJlwi4SQJpTTDepohg89Q2cdnWK8Z4HPLIdWxw+qH/uUET+hmp3wu48IkpqjlmmzCKkpgpk9GOzgKHSGh2Va2dp0lpKTVVIVNOqgHWMLP8DAhF4XScDAo4R+UkH20TFivNmEn9A+m7R4srG5DTq2zQ6lW9JCsG2KqlTRTLtzPCh1Z2TKD5O/WDvg3V9aopZe6IKO2GrUmyAhxNlFls54jIlmZVI1O6yRc/pMz4XI4AyexEk7Td0Tz3DvCuN0L69QSLJN2mMYXMPDWxrFMLtL6F4aIV9PLmHMHsRqIYy2SgsAVyYCxGklzXKEE7XbMT82x+4nqIbUT4y2x6tw/hHPvCy7fEdyBU6xRuvUoCd3RDBieaBprtLARSWIjnCDi56xHEpwNYjMSx2ZunZ5j8HfYu0zIJOsX2IwmsR1NEPFsTcJ7kCKSnA8HCXijjCS/t0WyzSxMLNjISnJsMdHBKb3MiBMJksT/Dz3j5RvmOCUxJacOBFu0W47tC7KdjwTVvzknZ/UjE2bXorQWPc5yQpuc0Can+A/7l6xqX8N3KgAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"electron tray mac dark\",\n    \"title\": \"electron tray mac dark\",\n    \"src\": \"/blog/static/4e3595865b2b933d6c2d4402413066c8/8594d/electron-tray-mac-dark.png\",\n    \"srcSet\": [\"/blog/static/4e3595865b2b933d6c2d4402413066c8/6a467/electron-tray-mac-dark.png 210w\", \"/blog/static/4e3595865b2b933d6c2d4402413066c8/8594d/electron-tray-mac-dark.png 316w\"],\n    \"sizes\": \"(max-width: 316px) 100vw, 316px\",\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"nativeTheme.shouldUseDarkColors\"), \" \\u53EF\\u4EE5\\u5224\\u65AD\\u7CFB\\u7EDF mode\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"  const getTrayIcon = () => path.resolve(__dirname, process.platform !== 'darwin' ? 'tray_win.png' : nativeTheme.shouldUseDarkColors ? 'tray_dark.png' : 'tray_light.png');\\n\")), mdx(\"h3\", null, \"\\u5207\\u6362\\u7CFB\\u7EDF Mode \\u5B9A\\u5236\\u6258\\u76D8\\u56FE\\u6807\\u6539\\u53D8\"), mdx(\"p\", null, mdx(\"img\", _extends({\n    parentName: \"p\"\n  }, {\n    \"src\": \"electron-tray-update-mac.gif\",\n    \"alt\": \"electron tray mac update\"\n  }))), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"nativeTheme\"), \" \\u63D0\\u4F9B \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"update\"), \" \\u76D1\\u542C\\u7CFB\\u7EDF\\u672C\\u8EAB\\u7684 Mode \\u53D8\\u5316\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \" // refresh icon when MacOS dark/light theme has changed\\n  nativeTheme.on('updated', () => tray && tray.setImage(getTrayIcon()));\\n\")), mdx(\"h3\", null, \"\\u6258\\u76D8\\u5176\\u4ED6\\u573A\\u666F\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u663E\\u793A\\u672A\\u8BFB\\u6D88\\u606F\\u6570 \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"tray.setTitle('6')\"), \";\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u6709\\u672A\\u8BFB\\u6D88\\u606F\\u65F6\\u56FE\\u6807\\u95EA\\u52A8\\uFF1A\\u901A\\u8FC7 \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"setImage\"), \" \\u5B9A\\u65F6\\u8F6E\\u8BE2\\u5207\\u6362\\u56FE\\u6807\\u5B9E\\u73B0\")), mdx(\"h2\", null, \"\\u6CE8\\u610F\\u4E8B\\u9879\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"MacOS\"), \" \\u5168\\u5C4F\\u9000\\u51FA\\u754C\\u9762\\u662F\\u4F1A\\u51FA\\u73B0\\u9ED1\\u5C4F\\u95EE\\u9898\\uFF0C\\u89E3\\u51B3\\u65B9\\u6848\")), mdx(\"p\", null, \"\\u5224\\u65AD\\u5982\\u679C\\u5168\\u5C4F\\uFF0C\\u5728\\u5173\\u95ED\\u5168\\u5C4F\\u65F6\\uFF0C\\u5148\\u9000\\u51FA\\u5168\\u5C4F\\u518D\\u9690\\u85CF\\u754C\\u9762\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"// \\u4FEE\\u590D\\u5168\\u5C4F hide \\u9ED1\\u5C4F\\u95EE\\u9898\\n// https://github.com/electron/electron/issues/20263\\nif (mainWindow.isFullScreen()) {\\n  mainWindow.once('leave-full-screen', () => mainWindow.hide());\\n  mainWindow.setFullScreen(false);\\n} else {\\n  mainWindow.hide();\\n}\\n\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"Windows\"), \" \\u4E0B\\u9762\\u70B9\\u51FB\\u5173\\u95ED\\u51FA\\u73B0\\u4E8C\\u6B21\\u786E\\u8BA4\\u6846\\uFF0C\\u4F46\\u662F\\u754C\\u9762\\u9A6C\\u4E0A\\u5173\\u95ED\")), mdx(\"p\", null, \"\\u9700\\u8981\\u963B\\u6B62\\u4E8B\\u4EF6\\u6D41\\uFF0C\\u5728 \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"close\"), \" \\u65F6\\u963B\\u6B62\\u5C31\\u53EF\\u4EE5\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"mainWindow.on('close', (e) => {\\n  ...\\n  e.preventDefault();\\n})\\n\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","headings":[{"value":"创建托盘和菜单示例","depth":2},{"value":"基于托盘功能实现后台运行应用","depth":2},{"value":"关闭应用前唤醒对话框二次确认","depth":3},{"value":"创建托盘并添加菜单操作","depth":3},{"value":"根据操作系统类型和系统 Mode 定制托盘图标","depth":3},{"value":"切换系统 Mode 定制托盘图标改变","depth":3},{"value":"托盘其他场景","depth":3},{"value":"注意事项","depth":2}],"frontmatter":{"title":"Electron 应用处理长任务","date":"2020-11-26","description":"通过 Electron 托盘（tray）实现后台执行长任务。"}},"file":{"relativePath":"electron-tray.pdf","publicURL":"/blog/static/electron-tray-27fe54320a2a35dcb6e21a8a18402462.pdf"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/electron-tray/","previous":{"fields":{"slug":"/json-tree/"},"frontmatter":{"title":"树形结构与扁平结构相互转换"}},"next":{"fields":{"slug":"/django_blog/"},"frontmatter":{"title":"Django 构建博客"}}}}}